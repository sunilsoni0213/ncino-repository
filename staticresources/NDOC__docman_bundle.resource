!function(n){var r={};function __webpack_require__(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,__webpack_require__),t.l=!0,t.exports}__webpack_require__.m=n,__webpack_require__.c=r,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)__webpack_require__.d(n,r,function(e){return t[e]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){n(1),n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47)},function(e,t){!function(){"use strict";angular.module("docman.extensions",[])}()},function(e,t){!function(){"use strict";function downloadService(e){return{before:function before(){return!1},after:function after(e){return null},execute:function execute(){return null}}}angular.module("docman.extensions").service("downloadService",downloadService),downloadService.$inject=["$q"]}()},function(e,t){!function(){"use strict";angular.module("docman.extensions").service("customLinkService",function customLinkService(){this.customLinkDefinitions=function customLinkDefinitions(){return[]}})}()},function(e,t){!function(){"use strict";function fileUploadService(e){return{before:function before(){return!1},after:function after(e){return null},execute:function execute(e,t,n){return null}}}angular.module("docman.extensions").service("fileUploadService",fileUploadService),fileUploadService.$inject=["$q"]}()},function(e,t){!function(){"use strict";angular.module("docman.picklist.manager",[])}()},function(e,t){!function(){"use strict";function picklistMetadataService(o){return{read:function read(e,t){for(var n='<?xml version="1.0" encoding="UTF-8"?><env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header><SessionHeader xmlns="http://soap.sforce.com/2006/04/metadata"><sessionId>'+UniDocMan.sessionId+'</sessionId></SessionHeader></env:Header><env:Body><readMetadata xmlns="http://soap.sforce.com/2006/04/metadata"><type>'+e+"</type>",r=0;r<t.length;r++)n+="<fullNames>"+t[r]+"</fullNames>";return o({method:"POST",url:"/services/Soap/m/37.0",headers:{"Content-Type":"text/xml",SOAPAction:'""'},data:n+="</readMetadata></env:Body></env:Envelope>"})},update:function update(e){for(var t='<?xml version="1.0" encoding="UTF-8"?><env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header><SessionHeader xmlns="http://soap.sforce.com/2006/04/metadata"><sessionId>'+UniDocMan.sessionId+'</sessionId></SessionHeader></env:Header><env:Body><updateMetadata xmlns="http://soap.sforce.com/2006/04/metadata">',n=0;n<e.length;n++)t+=e[n];return o({method:"POST",url:"/services/Soap/m/37.0",headers:{"Content-Type":"text/xml",SOAPAction:'""'},data:t+="</updateMetadata></env:Body></env:Envelope>"})},createPicklistXml:function createPicklistXml(e,t,n){var r="<picklist>";t&&(r+="<controllingField>"+t+"</controllingField>");for(var o=0;o<e.length;o++){if(r+="<picklistValues><fullName>"+e[o].name+"</fullName><default>false</default>",t)for(var a=0;a<e[o].controllingFieldValues.length;a++)r+="<controllingFieldValues>"+e[o].controllingFieldValues[a]+"</controllingFieldValues>";r+="</picklistValues>"}t&&n&&(r+="<restrictedPicklist>"+n+"</restrictedPicklist>");return r+="<sorted>false</sorted></picklist>"}}}angular.module("docman.picklist.manager").service("picklistMetadataService",picklistMetadataService),picklistMetadataService.$inject=["$http"]}()},function(e,t){!function(){"use strict";function picklistValueService(n,r){var o=this;o.loadPicklistValues=function loadPicklistValues(e){var t=r.defer();return n.read("CustomField",e).then(function(e){jQuery(e.data).find("picklist").each(function(e,t){0===e?(o.picklistValues=[],jQuery(this).find("picklistValues").each(function(e,t){var n=jQuery(this).children("fullName").text();o.picklistValues.push({id:e,reason:n,comment:""})})):1===e&&jQuery(this).find("picklistValues").each(function(){var n=jQuery(this).children("fullName").text();jQuery(this).find("controllingFieldValues").each(function(){for(var e=jQuery(this).text(),t=0;t<o.picklistValues.length;t++)o.picklistValues[t].reason===e&&(o.picklistValues[t].comment=n)})})}),t.resolve(o.picklistValues)}),t.promise},o.picklistValues=[]}angular.module("docman.picklist.manager").service("picklistValueService",picklistValueService),picklistValueService.$inject=["picklistMetadataService","$q"]}()},function(e,t){!function(){"use strict";function uploadService(s,d,u,f,p,E,g,r,h,m){var T=this;return T.service={archiveExistingDocument:function archiveExistingDocument(e){if(e.isExternalReference){var t=r.defer();return t.resolve(),t.promise}return E.archiveExistingDocument(e.recordId,e.file.Id)},uploadContentDocument:function uploadContentDocument(t,n,r,o,a){var e=t.name.substr(t.name.lastIndexOf(".")+1).toLowerCase();if(null!==s.allowedFileExtensions&&0<s.allowedFileExtensions.length&&-1===s.allowedFileExtensions.indexOf(e))return void s.$evalAsync(function(){T.service.showToast=!0});var i=h.get().systemPropsMap.get(p.UNI_DOCMAN_FILE_SIZE_LIMIT);if(null!==i&&i){var l=Math.round(10*t.size/1024e3)/10;if(i<l)return void s.$evalAsync(function(){T.service.showSizeToast=!0})}var c=g.uploadingToPlaceholder;g.uploadingToPlaceholder.file&&g.uploadingToPlaceholder.file.ParentId?T.service.shouldOverwrite().then(function(e){e?(T.service.archiveExistingDocument(g.uploadingToPlaceholder).then(function(){d.retrieveArchivedDocumentsWithAttachments(function(e){s.archivedFiles=e,g.convertPropertyNamesFromCamelCase(s.archivedFiles)})}),g.uploadingToPlaceholder={},upload(t,n,c,r,o,a)):(g.uploadingToPlaceholder={},o(u.CANCEL_OVERWRITE))}):(g.uploadingToPlaceholder={},upload(t,n,c,r,o,a))},shouldOverwrite:function shouldOverwrite(){var n=r.defer();return s.$broadcast(u.SHOW_OVERWRITE_MODAL),s.$on(u.OVERWRITE_CONFIRM,function(e,t){n.resolve(t)}),n.promise},showToast:!1,showSizeToast:!1},T.service;function upload(n,r,o,a,i,e){if(function uploadExtensionExists(){return void 0!==m.before&&typeof m.before===u.FUNCTION&&void 0!==m.after&&typeof m.after===u.FUNCTION&&void 0!==m.execute&&typeof m.execute===u.FUNCTION}()&&!0===m.before()){var l={isExternal:!0},t=g.generateFileMetadata(o,n);E.createExternalDocumentStorageMetadata(o.recordId,n.name,t).then(function(e){var t={contextId:window.DocManId,documentVersionId:e.documentVersionId,placeholderId:o.recordId,documentStoreId:e.parentId};m.execute(n,r,t).then(function(e){m.after(e),s.$broadcast(u.UPDATE_PLACEHOLDER_STATUS,o,u.STATUS_IN_FILE),a(l)},function(e){m.after(e),i(l)})})}else{var c={Origin:"C",PathOnClient:n.name,Title:n.name};!function createBlob(e,t,n,r,o){var a=new forcetk.Client(null,null,null);f.SITE_PREFIX&&(a.setSessionToken=function(e,t,n){this.sessionId=e,this.apiVersion=null==t?"v41.0":t,this.instanceUrl=null==n?"https://"+location.hostname+f.SITE_PREFIX:n,this.proxyUrl=null,this.visualforce=!1});a.setSessionToken(d.sessionId),a.createBlob("ContentVersion",t,e.name,"VersionData",e,n,r,null,o)}(n,c,a,i,e)}}}angular.module("app").service("uploadService",uploadService),uploadService.$inject=["$rootScope","dataService","CONSTANTS","FILE","SYSTEM_PROPERTIES","universalDocManRemotingService","placeholderService","$q","config","fileUploadService"]}()},function(e,t){!function(){"use strict";function defaultDownloadService(a,i,o,l,c){return{downloadMultipleFiles:function downloadMultipleFiles(e){var t=[],n=[];(function retrievePlaceholdersWithAttachments(e,n,r){angular.forEach(e,function(e,t){e.isSelected&&e.file&&(e.file.RecordType===o.ATTACHMENT?n.push(e):e.file.RecordType===o.FILE&&r.push(e))})})(e,t,n),function downloadContent(e){var t=c.defer();if(0<e.length){var n={},r={},o="";angular.forEach(e,function(e,t){e.file.Id&&(o+=e.file.Id+"/")}),function createContentDocumentDownloadTitles(e,n,r){angular.forEach(e,function(e,t){n[e.file.Id]=generateDownloadTitle(e),r[e.file.Id]=e.file.Title})}(e,n,r),l.renameMultipleContentDocuments(n).then(function(){o=o.substring(0,o.length-1),function initiateContentDocumentDownload(e,t){window.open(i.CONTENT_DOWNLOAD_URL+t).addEventListener("unload",function(){l.renameMultipleContentDocuments(e)},!0)}(r,o)})}return t.resolve(),t.promise}(n).then(function downloadAttachments(e){angular.forEach(e,function(e){updateFileTitleAndDownload(e.file.Id,generateDownloadTitle(e),!1,getDownloadLink(i.ATTACHMENT_DOWNLOAD_URL,e.file.Id,e.downloadAsPDF),e.file.Title)})}(t))},downloadVersion:function downloadVersion(e,t){window.open(getDownloadLink(i.CONTENT_DOWNLOAD_URL,e,t))},getDownloadLink:getDownloadLink,executeDownload:function executeDownload(t){var n;t.file.RecordType===i.ATTACHMENT?updateFileTitleAndDownload(t.file.Id,generateDownloadTitle(t),!1,getDownloadLink(i.ATTACHMENT_DOWNLOAD_URL,t.file.Id,t.downloadAsPDF),t.file.Title):t.file.Id&&!t.isDocumentExternal?updateFileTitleAndDownload(n=t.file.Id,generateDownloadTitle(t),!0,getDownloadLink(i.CONTENT_DOWNLOAD_URL,n,t.downloadAsPDF),t.file.Title):t.isDocumentExternal?window.open(t.file.externalDownloadUrl):l.getContentDocumentLink(t.file.ParentId).then(function(e){updateFileTitleAndDownload(n=e.ContentDocument.LatestPublishedVersionId,generateDownloadTitle(t),!0,getDownloadLink(i.CONTENT_DOWNLOAD_URL,n,t.downloadAsPDF),t.file.Title)})},updateFileTitleAndDownload:updateFileTitleAndDownload};function updateFileTitleAndDownload(e,t,n,r,o){a.updateFileTitle(e,t,n,function(){window.setTimeout(function(){window.open(r).addEventListener("unload",function(){a.updateFileTitle(e,o,n,function(){})},!0)},1e3)})}function generateDownloadTitle(e){var t=e.name;return e.year&&(t+=i.DASH+e.year),t+=e.file.Title.substring(e.file.Title.lastIndexOf(i.PERIOD))}function getDownloadLink(e,t,n){var r=e+t;return n&&(r+=i.AS_PDF),r}}angular.module("app").service("defaultDownloadService",defaultDownloadService),defaultDownloadService.$inject=["dataService","FILE","FILE_RECORD_TYPES","universalDocManRemotingService","$q"]}()},function(e,t){!function(){"use strict";function dataService(e,t){var a=this;return a.config=t.get(),a.namespacePrefix=a.config.namespacePrefix?a.config.namespacePrefix.replace("__","."):"nDOC.",{addChatterComment:function addChatterComment(e,t,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.addChatterComment",e,t,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r&&r.apply(this,[t,e]))},{escape:!1,buffer:!1})},addNewPlaceholder:function addNewPlaceholder(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"PlaceholderDataController.addNewPlaceholder",window.DocManId,e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},configureContextObject:function configureContextObject(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.configureContextObject",a.config.contextIdPageParam,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},createFileStagingPlaceholder:function createFileStagingPlaceholder(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.createFileStagingPlaceholder",window.DocManId,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},deletePlaceholder:function deletePlaceholder(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.deletePlaceholder",window.DocManId,e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r&&r.apply(this,[t,e]))},{escape:!1,buffer:!1})},deletePlaceholderIndex:function deletePlaceholderIndex(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.deletePlaceholderIndex",window.DocManId,e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},dispatchErrorEvent:UniDocMan.dispatchErrorEvent,duplicatePlaceholder:function duplicatePlaceholder(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.duplicatePlaceholder",window.DocManId,e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},getNamespacePrefix:function getNamespacePrefix(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.getNamespacePrefix",function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveArchivedDocumentsWithAttachments:function retrieveArchivedDocumentsWithAttachments(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.retrieveArchivedDocumentsWithAttachments",window.DocManId,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveCategories:function retrieveCategories(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"PlaceholderDataController.retrieveCategories",window.DocManId,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveChatterComments:function retrieveChatterComments(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.retrieveChatterComments",e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveDocumentsWithAttachmentsForSpecifiedId:function retrieveDocumentsWithAttachmentsForSpecifiedId(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.retrieveDocumentsWithAttachments",e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveFileStagingPlaceholders:function retrieveFileStagingPlaceholders(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.retrieveFileStagingPlaceholders",window.DocManId,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrievePlaceholderFieldSet:function retrievePlaceholderFieldSet(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"PlaceholderDataController.retrievePlaceholderFieldSet",e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrievePlaceholderWithFields:function retrievePlaceholderWithFields(e,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"PlaceholderDataController.retrievePlaceholderWithFields",e,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},retrieveUserAssignedPermissions:function retrieveUserAssignedPermissions(n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.retrieveUserAssignedPermissions",function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},sessionId:window.UniDocMan.sessionId,updateAccountOnPlaceholder:function updateAccountOnPlaceholder(e,t,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.updateAccountOnPlaceholder",e,t,window.DocManId,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})},updateFileTitle:function updateFileTitle(e,t,n,r,o){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"UniversalDocManController.updateFileTitle",e,t,n,function(e,t){t.status?r.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),o.apply(this,[t,e]))},{escape:!1,buffer:!1})},updatePlaceholderStatus:function updatePlaceholderStatus(e,t,n,r){return Visualforce.remoting.Manager.invokeAction(a.namespacePrefix+"PlaceholderDataController.updatePlaceholderStatus",e,t,function(e,t){t.status?n.apply(this,[e]):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.apply(this,[t,e]))},{escape:!1,buffer:!1})}}}angular.module("app").service("dataService",dataService),dataService.$inject=["$q","config"]}()},function(e,t){!function(){"use strict";function universalDocManRemotingService(l,e){var c=this;return c.config=e.get(),c.namespacePrefix=c.config.namespacePrefix?c.config.namespacePrefix.replace("__","."):"nDOC.",{archivePlaceholderFromFileStaging:function archivePlaceholderFromFileStaging(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.archivePlaceholderFromFileStaging",window.DocManId,e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},createFileStagingPlaceholder:function createFileStagingPlaceholder(){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.createFileStagingPlaceholder",window.DocManId,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},archivePlaceholdersFromFileStaging:function archivePlaceholdersFromFileStaging(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.archivePlaceholdersFromFileStaging",window.DocManId,e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},archiveExistingDocument:function archiveExistingDocument(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.archiveExistingDocument",window.DocManId,e,t,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrievePlaceholderFieldSetAdd:function retrievePlaceholderFieldSetAdd(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.retrievePlaceholderFieldSetAdd",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},takeOwnershipOfDocument:function takeOwnershipOfDocument(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"SuperUserUtils.takeOwnershipOfDocument",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrievePlaceholderNames:function retrievePlaceholderNames(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.getPlaceholderNames",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrievePledgedCollateral:function retrievePledgedCollateral(){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.getPledgedCollateral",window.DocManId,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveLoanTeamMembers:function retrieveLoanTeamMembers(){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.getLoanTeamMembers",window.DocManId,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveSystemPropertyAsBoolean:function retrieveSystemPropertyAsBoolean(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.retrieveSystemPropertyAsBoolean",e,t,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},isDocStoreShared:function isDocStoreShared(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.isDocStoreShared",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},savePlaceholderData:function savePlaceholderData(e,t,n){var r=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.savePlaceholderData",window.DocManId,e,t,n,function(e,t){t.status?r.resolve(e):r.reject(t.message)},{escape:!1,buffer:!1}),r.promise},savePlaceholderPortalData:function savePlaceholderPortalData(e,t,n){var r=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"PlaceholderDataController.SavePlaceholderPortalDataEndpoint",{contextObjectId:window.DocManId,placeholderId:e,placeholder:JSON.stringify(t),fieldsToNull:JSON.stringify(n)},function(e,t){t.status?r.resolve(e):r.reject(t.message)},{escape:!1,buffer:!1}),r.promise},savePortalRejectionReasons:function savePortalRejectionReasons(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.savePortalRejectionReasons",window.DocManId,e,t,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},removeFileFromPlaceholders:function removeFilesFromPlaceholders(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.removeFilesFromPlaceholders",window.DocManId,e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},renameMultipleContentDocuments:function renameMultipleContentDocuments(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.renameMultipleContentDocuments",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveAttachment:function retrieveAttachment(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.retrieveAttachment",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1},{buffer:!1}),n.promise},updatePlaceholderFields:function updatePlaceholderFields(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.updatePlaceholderFields",window.DocManId,e,t,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveDocuments:function retrieveDocuments(){var n=l.defer();""===window.DocManId&&(window.DocManId=c.config.contextIdPageParam);return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.retrieveDocuments",window.DocManId,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveIsTranslated:function retrieveIsTranslated(){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniversalDocManController.RetrieveIsTranslated",{},function(e,t){t.status?n.resolve(e):n.reject(t.message)},{buffer:!1,escape:!1}),n.promise},retrieveMultiplePledgedCollateral:function retrieveMultiplePledgedCollateral(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"PlaceholderDataController.getMultiplePledgedCollateral",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},retrieveLegalEntities:function retrieveLegalEntities(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.retrieveLegalEntities",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!1}),n.promise},getContentDocumentLink:function getContentDocumentLink(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.getContentDocumentLink",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!0}),n.promise},getContentDocumentLinks:function getContentDocumentLinks(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.getContentDocumentLinks",e,function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!0}),n.promise},getDocumentVersions:function getDocumentVersions(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.getDocumentVersions",{placeholderId:e},function(e,t){t.status?n.resolve(e):n.reject(t.message)},{escape:!1,buffer:!0}),n.promise},getContentDocumentByVersion:function getContentDocumentByVersion(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.getContentDocumentByVersion",{contentVersionId:e,contentDocumentId:t},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},setPreviewUrlCount:function setPreviewUrlCount(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.setPreviewUrlCount",{contentVersionId:e,previewUrlCount:t},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},linkRelationshipDocuments:function linkRelationshipDocuments(e,t,n,r){var o=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.linkRelationshipDocumentsWithAddtionalProperties",e,t,n,r,function(e,t){t.status?o.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),o.reject(t.message))},{escape:!1,buffer:!1}),o.promise},createDocumentStorageMetadata:function createDocumentStorageMetadata(e,t,n,r){var o=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.createDocumentStorageMetadataWithAdditionalParameters",e,t,n,r,function(e,t){t.status?o.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),o.reject(t.message))},{escape:!1,buffer:!1}),o.promise},createExternalDocumentStorageMetadata:function createExternalDocumentStorageMetadata(e,t,n){var r=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.createExternalDocumentStorageMetadata",{placeholderId:e,fileName:t,additionalProperties:n},function(e,t){t.status?r.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),r.reject(t.message))},{escape:!1,buffer:!1}),r.promise},getConfigurableColumns:function getConfigurableColumns(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.retrieveConfigurableColumns",e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},createCollection:function createCollection(e,t){var n=l.defer(),r=function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))};t?Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.CreateCollection",{contextId:window.DocManId,docStoreIds:JSON.stringify(e)},r,{escape:!1,buffer:!1}):Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.createCollection",e,r,{escape:!1,buffer:!1});return n.promise},deleteCollection:function deleteCollection(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.deleteCollection",{collectionId:e},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},sendCollection:function sendCollection(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.sendCollectionForSignature",{collectionId:e,signerMessage:t,contextObjectId:window.DocManId},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},getCollectionIds:function getCollectionIds(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.getCollectionIds",e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},cancelSignatureCollection:function cancelSignatureCollection(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction(c.namespacePrefix+"UniversalDocManController.cancelSignatureCollection",e,function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},getESignatureDefaultMessage:function getESignatureDefaultMessage(){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.getESignatureDefaultMessage",{contextObjectId:window.DocManId},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},linkDocumentVersion:function linkDocumentVersion(e,t,n,r,o,a){var i=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.LinkDocumentVersion",{sourceContentVersionId:e,targetPlaceholderId:t,additionalProperties:n,isImported:r,isExternalDocument:o,fileName:a},function(e,t){t.status?i.resolve(e):i.reject(t.message)},{escape:!1,buffer:!1}),i.promise},retrieveDependentPicklist:function retrieveDependentPicklist(e,t,n){var r=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.retrieveDependentPicklist",{objectType:e,controllingField:t,dependentField:n},function(e,t){t.status?r.resolve(e):r.reject(t.message)},{escape:!1,buffer:!1}),r.promise},getReviewStatusOptions:function getReviewStatusOptions(){var n=l.defer();""===window.DocManId&&(window.DocManId=c.config.contextIdPageParam);return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.retrieveReviewStatusOptions",{contextObjectId:window.DocManId},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},requestPortalDocuments:function requestPortalDocuments(e){var n=l.defer(),t=JSON.stringify(e);return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.requestPortalDocuments",{placeholders:t,contextObjectId:window.DocManId},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},cancelPortalRequests:function cancelPortalRequests(e){var n=l.defer(),t=JSON.stringify(e);return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.cancelPortalRequests",{placeholderIds:t,contextObjectId:window.DocManId},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},getBulkUpdateScreenSectionData:function getBulkUpdateScreenSectionData(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.getBulkUpdateScreenSectionData",{contextId:e,placeholderIds:JSON.stringify(t)},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},updateRequirementRemote:function updateRequirementRemote(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.updateRequirementRemote",{placeholderIds:JSON.stringify(e)},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},retrieveActiveDocumentCollections:function retrieveActiveDocumentCollections(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.RetrieveActiveDocumentCollections",{collectionIds:JSON.stringify(e)},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},associateDocsToCollection:function associateDocsToCollection(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.AssociateDocsToCollection",{contextId:window.DocManId,docStoreIds:JSON.stringify(e),collectionId:t},function(e,t){t.status?n.resolve(e,t):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},createVendorCollection:function createVendorCollection(e,t){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.CreateVendorCollection",{contextId:window.DocManId,docStoreIds:JSON.stringify(e),collectionId:t},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},unlinkRequirementFromPlaceholder:function unlinkRequirementFromPlaceholder(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.unlinkRequirementFromPlaceholder",{placeholderIds:JSON.stringify(e)},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise},getESignatureTaggingUrl:function getESignatureTaggingUrl(e){var n=l.defer();return Visualforce.remoting.Manager.invokeAction("nFORCE.RemoteActionController.invoke",c.namespacePrefix+"UniDocManRemoteActionController.GetESignatureTaggingUrl",{collectionId:e},function(e,t){t.status?n.resolve(e):(UniDocMan.dispatchErrorEvent(t.type,t.message,t.where),n.reject(t.message))},{escape:!1,buffer:!1}),n.promise}}}angular.module("app").service("universalDocManRemotingService",universalDocManRemotingService),universalDocManRemotingService.$inject=["$q","config"]}()},function(e,t){!function(){"use strict";function commonService(l,i,a,c,s,d,u,e,r,f,p,t,E){var g=E.getLabels();return{updatePlaceholderProperties:function updatePlaceholderProperties(e,t,n,r){e.file=n,p.convertPropertyNamesFromCamelCase([e]),e.file.ContentSize&&(e.file.Size=e.file.ContentSize);e.file.ParentId&&(e.documentStoreId=e.file.ParentId);e.accountId=r,p.setStatuses(e),e.uploadingFile=!1,t(e)},uploadProgress:function uploadProgress(e,t,n){e.uploadingFile||(e.uploadingFile=!0);e.uploadProgress=n||Math.floor(t.loaded/t.total*100);100==e.uploadProgress&&setTimeout(function(){e.uploadingFile=!1},1200)},getDataTransfer:function getDataTransfer(e){return e.dataTransfer||e.originalEvent.dataTransfer},createFileStagingPlaceholder:function createFileStagingPlaceholder(t,n,o,a){f.createFileStagingPlaceholder().then(function(e){var r=e[0];c.stagedFiles.push(r),r.uploadingFile||(r.uploadingFile=!0),r.fileUploadingText=g.UPLOADING+" "+t.name+s.THREE_PERIODS,p.uploadingToPlaceholder=r,i.uploadContentDocument(t,n,function(e){if(!(r.uploadingFile=!1)===e.isExternal)return c.retrieveFileStagingPlaceholders().then(function(){}),void(a&&a());f.createDocumentStorageMetadata(e.id,r.recordId,null,p.generateFileMetadata(r,t)).then(function(e){r.file=e,p.prepareForUrls([r]).then(function(){a&&a()})})},function(e,t,n){o.$apply(function(){r.uploadingFile=!1,console.log(e),console.log(t),console.log(n)})},function(e){o.$apply(function(){r.uploadingFile||(r.uploadingFile=!0),r.uploadProgress=Math.floor(e.loaded/e.total*100)})})})},getDateFieldNames:getDateFieldNames,formatDateFieldsForDisplay:function formatDateFieldsForDisplay(e,t){for(var n=0;n<t.length;n++){var r=t[n];e[r]&&(e[r]=convertMillisecondsToDate(e[r]))}},formatDateFieldsForInput:function formatDateFieldsForInput(e,t){for(var n=getDateFieldNames(t),r=0;r<n.length;r++){var o=n[r];e.fields[o]&&(e.fields[o]=formatUTCDateToMilliseconds(new Date(e.fields[o])))}},formatMillisecondsToUTCDate:function formatMillisecondsToUTCDate(e){return e?(e=parseInt(e),window.LifeCycle.Internationalize.format(new Date(parseInt(e)),"zzz")):""},formatUTCDateToMilliseconds:formatUTCDateToMilliseconds,checkForExistingContentDocument:function checkForExistingContentDocument(e){var t=r.defer(),n=null;e.ParentId&&(n=e.ParentId);null!=n?f.isDocStoreShared(n).then(function(e){!0===e&&(n=null),t.resolve([null,n])}):t.resolve([null,n]);return t.promise},performStatusUpdate:function performStatusUpdate(t,n,r){if(n&&r){var o=n.status,e=document.getElementById("status-btn-"+n.recordId);setElementOpacity(e,"0.5"),a.updatePlaceholderStatus(n.recordId,r,function(){var e;r!=o&&(e=g.STATUS_CHANGED_FROM+" "+E.getLabel(o,1)+" "+g.TO_LABEL+" "+E.getLabel(r,1)+s.PERIOD),r.translation===E.getLabel(s.STATUS_EXCEPTION)&&n.portalEnabled&&(e+=" "+g.PORTAL_REJECTION_REASON_CHANGED+" "+n.portalRejectionReason+" "+g.PORTAL_REJECTION_COMMENT_CHANGED+" "+n.portalRejectionComment+s.DOUBLE_QUOTE+s.PERIOD),n.newComment&&(e+="  "+n.newComment),n.newComment=e,f.savePlaceholderData(n.recordId,null,null).then(function(e){!function retrievePlaceholderWithFields(n,r,e){var o=document.getElementById("status-btn-"+r.recordId);a.retrievePlaceholderWithFields(r.recordId,function(t){a.retrievePlaceholderFieldSet(r.recordId,function(e){n.$apply(function(){r.fieldSetSchema=JSON.parse(e),r.fields=t,r.status!==E.getLabel(s.STATUS_EXCEPTION)&&angular.forEach(s.EXCEPTION_DATE_FIELDS,function(e,t){r.fields[t]&&(r.fields[t]=null)}),n.controller.retrieveChatterComments(n.controller.selectedPlaceholder)}),setElementOpacity(o,"1.0")},function(){setElementOpacity(o,"1.0"),r.status=e})},function(){r.status=e})}(t,n,o),p.copyPlaceholderProperties(e[0],n),t.controller.addChatterComment(n),n.file?n.file.previewLoaded=!0:n.file={previewLoaded:!0,previewLink:""},p.setStatuses(n)})},function(){setElementOpacity(e,"1.0"),n.status=o})}},copyToClipboard:function copyToClipboard(e){var t=!1;if(window.clipboardData&&window.clipboardData.setData)t=clipboardData.setData("Text",e);else if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var n=document.createElement("textarea");n.textContent=e,n.style.position="fixed",document.body.appendChild(n),n.select();try{t=document.execCommand("copy")}finally{document.body.removeChild(n)}}var r=angular.element("button.slds-notify__close");r.css("opacity",0);var o=u.ERROR,a=d.THEME_ERROR,i=d.COPY_ERROR_MSG;t&&(o=u.SUCCESS,a=d.THEME_SUCCESS,i=d.LINK_COPY_SUCCESS_MSG);l.$broadcast(s.SET_TOAST,{type:o,theme:a,body:i}),setTimeout(function(){r.click().css("opacity",1)},1500)},normalizeCompare:function normalizeCompare(e,t){if(e.length&&t.length)return e.toLowerCase()==t.toLowerCase();return!1},setElementOpacity:setElementOpacity,convertMillisecondsToDate:convertMillisecondsToDate,addOffsetAndConvertToDateTime:function addOffsetAndConvertToDateTime(e){return convertMillisecondsToDateTime(function applyAggregateOffset(e,t){return window.LifeCycle.Internationalize.timeZoneUtil.applyAggregateOffset(e,t)}("add",e))},convertMillisecondsToDateTime:convertMillisecondsToDateTime,getDocStoresFromSelectedPlaceholders:function getDocStoresFromSelectedPlaceholders(e){for(var t=[],n=0;n<e.length;n++)e[n].isSelected&&t.push(e[n].documentStoreId);return t},getChatterStatusChangeComment:function getChatterStatusChangeComment(e,t,n){var r=e+" "+g.WAS_ADDED+s.PERIOD;t&&t!==n&&(r+=" "+g.STATUS_CHANGED_FROM+" "+E.getLabel(t,1)+" "+g.TO_LABEL+" "+E.getLabel(n,1)+s.PERIOD);return r}};function getDateFieldNames(e){for(var t=[],n=0;n<e.length;n++)e[n].type===s.DATE_TYPE&&t.push(e[n].fieldPath);return t}function formatUTCDateToMilliseconds(e){return new Date(e).getTime()}function convertMillisecondsToDate(e){return e?(e+=6e4*new Date(e).getTimezoneOffset(),new String(new Date(parseInt(e))).replace('"',"")):null}function convertMillisecondsToDateTime(e){return e?new String(new Date(parseInt(e))).replace('"',""):null}function setElementOpacity(e,t){e&&(e.style.opacity=t)}}angular.module("app").service("commonService",commonService),commonService.$inject=["$rootScope","uploadService","dataService","fileStagingService","CONSTANTS","ALERT_DIALOG","TOAST_TYPES","$filter","$q","universalDocManRemotingService","placeholderService","config","labels"]}()},function(e,t){!function(){"use strict";function permissionService(r,n,o,t,e,a,i,l){var c=this;c.configValues=i.get();var s=[],d=!1,u=!1,f=!1,p=!1,E=!1,g=!1,h=!1,m=!1,T=!1,v=!1,S=!1,P=!1,_=!1,C=!1,D=!1,A=!1,I=!1,N=!1,R=!1,O=!1,L=!1,w=!1,U=!1,M=!1;return c.userProfileName="",c.userGroupsList=[],c.userDocTypes=null,{hasCollateralImport:function hasCollateralImport(){return M},hasDeleteFilesPermission:hasDeleteFilesPermission,hasDeletePlaceholderPermission:hasDeletePlaceholderPermission,hasEditAfterApprovalPermission:function hasEditAfterApprovalPermission(e,t,n){return!(isESignLockedPlaceholder(t)&&!n||t==l.getLabel(o.STATUS_APPROVED)&&!f)&&hasPermission(c.configValues.contextObjectType,e)},hasEditDetailsPermission:hasEditDetailsPermission,hasPermission:hasPermission,hasPortalAdminPermission:hasPortalAdminPermission,hasPrepareForESignature:function hasPrepareForESignature(){return p&&D},hasProductPackageLevelPermission:hasProductPackageLevelPermission,hasRelationshipImport:function hasRelationshipImport(){return U},hasRequiredRole:hasRequiredRole,hasRequiredViewerAccess:function hasRequiredViewerAccess(e){var t=[];if(null!=e){var n=function hasRequiredDocType(e){if(null==c.userDocTypes)return!0;var t=e?e.trim().toLowerCase():e;return 0!==c.userDocTypes.length&&-1<c.userDocTypes.indexOf(t)}(e.category);if(!n)return!1;null!=e.viewerGroups&&0<e.viewerGroups.trim().length&&t.push(function hasRequiredGroup(e){if(!c.userGroupsList)return!1;for(var t=0;t<c.userGroupsList.length;t++)if(checkListForString(e,c.userGroupsList[t].toLowerCase().trim()))return!0;return!1}(e.viewerGroups)),null!=e.viewerProfiles&&0<e.viewerProfiles.trim().length&&t.push(function hasRequiredProfile(e){return checkListForString(e,c.userProfileName)}(e.viewerProfiles)),null!=e.viewerRoles&&0<e.viewerRoles.trim().length&&t.push(hasRequiredRole(e.viewerRoles))}for(var r=0;r<t.length;r++)if(t[r])return!0;return 0===t.length},hasReviewDocumentsPermission:hasReviewDocumentsPermission,initialize:function initialize(e){(function retrieveImportPermissions(){U=i.get().systemPropsMap.get(t.RELATIONSHIP_IMPORT_KEY),M=i.get().systemPropsMap.get(t.COLLATERAL_IMPORT_KEY)})(),setUserGroupsList(c.configValues.userGroupsList),setUserProfileName(c.configValues.userProfileName),setUserDocTypes(c.configValues.userDocTypes),angular.forEach(e,function(e,t){var n=e;switch(this.push(e),n){case r.APPROVED:!0;break;case r.EDIT:!0;break;case r.EMPTY_STAGING:!0;break;case r.UPLOAD:!0;break;case r.UNI_CREATE_PLACEHOLDER_NAME:d=!0;break;case r.UNI_EDIT_AFTER_APPROVAL:f=!0;break;case r.UNI_EDIT_DETAILS:p=!0;break;case r.UNI_EDIT_LOAN_DETAILS:E=!0;break;case r.UNI_EDIT_TREASURY_DETAILS:g=!0;break;case r.UNI_EDIT_DEPOSIT_DETAILS:h=!0;break;case r.UNI_DELETE:u=!0;break;case r.UNI_DELETE_LOAN_FILES:m=!0;break;case r.UNI_DELETE_TREASURY_FILES:T=!0;break;case r.UNI_DELETE_DEPOSIT_FILES:v=!0;break;case r.UNI_PORTAL_ADMIN:O=!0;break;case r.UNI_LOAN_PORTAL_ADMIN:L=!0;break;case r.UNI_DEPOSIT_PORTAL_ADMIN:w=!0;break;case r.UNI_PREPARE_FOR_E_SIGNATURE:D=!0;break;case r.UNI_REVIEW_DOCUMENTS:A=!0;break;case r.UNI_REVIEW_LOAN_DOCUMENTS:I=!0;break;case r.UNI_REVIEW_TREASURY_DOCUMENTS:N=!0;break;case r.UNI_REVIEW_DEPOSIT_DOCUMENTS:R=!0;break;case r.UNI_DELETE_PLACEHOLDERS:S=!0;break;case r.UNI_DELETE_LOAN_PLACEHOLDERS:C=!0;break;case r.UNI_DELETE_DEPOSIT_PLACEHOLDERS:_=!0;break;case r.UNI_DELETE_TREASURY_PLACEHOLDERS:P=!0}},s)},isESigPendingCanceledException:function isESigPendingCanceledException(e){var t=e?e.toUpperCase():"";return-1<[o.STATUS_SIGNATURE_CANCEL_PENDING.toUpperCase(),o.STATUS_SIGNATURE_PENDING.toUpperCase(),o.STATUS_SIGNATURE_EXCEPTION.toUpperCase()].indexOf(t)},isESignLockedPlaceholder:isESignLockedPlaceholder,isLockedPlaceholder:function isLockedPlaceholder(e){return isESignLockedPlaceholder(e)},notHaveViewingRole:function notHaveViewingRole(e){return!hasRequiredRole(e)},setUserGroupsList:setUserGroupsList,setUserProfileName:setUserProfileName,setUserRoleName:function setUserRoleName(e){null!=e&&(c.userRoleName=e.toLowerCase().trim())},setUserDocTypes:setUserDocTypes};function setUserGroupsList(e){c.userGroupsList=e}function setUserProfileName(e){c.userProfileName=e.toLowerCase().trim()}function setUserDocTypes(e){if(null!=e){c.userDocTypes=[];for(var t=0;t<e.length;t++)c.userDocTypes.push(e[t].trim().toLowerCase())}else c.userDocTypes=null}function hasPermission(e,t){if(e===o.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&null!=a.selectedProductInProductPackage&&(e=a.selectedProductInProductPackage.objectType)===o.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE)return hasProductPackageLevelPermission(t);if(t===n.UNI_EDIT_DETAILS)return hasEditDetailsPermission(e);if(t===n.UNI_DELETE)return hasDeleteFilesPermission(e);if(t===n.UNI_PORTAL_ADMIN)return hasPortalAdminPermission(e);if(t===n.UNI_REVIEW_DOCUMENTS)return hasReviewDocumentsPermission(e);if(t===n.UNI_DELETE_PLACEHOLDERS)return hasDeletePlaceholderPermission(e);switch(t){case n.UNI_CREATE_PLACEHOLDER_NAME:return d;default:return!1}}function hasProductPackageLevelPermission(n){var r=!1;return angular.forEach(a.productPackageProducts,function(e,t){e.objectType!=o.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&hasPermission(e.objectType,n)&&(r=!0)}),r}function hasDeletePlaceholderPermission(e){return!!e&&(!!S||(e===o.CONTEXT_OBJECT_TYPE_ACCOUNT?C||P||_:e===o.CONTEXT_OBJECT_TYPE_LOAN||e===o.CONTEXT_OBJECT_TYPE_COLLATERAL?C:e===o.CONTEXT_OBJECT_TYPE_TREASURY?P:e!==o.CONTEXT_OBJECT_TYPE_DEPOSIT||_))}function hasEditDetailsPermission(e){return!!e&&(!!p||(e===o.CONTEXT_OBJECT_TYPE_ACCOUNT?p||E||h||g:e===o.CONTEXT_OBJECT_TYPE_LOAN||e===o.CONTEXT_OBJECT_TYPE_COLLATERAL?E:e===o.CONTEXT_OBJECT_TYPE_TREASURY?g:e!==o.CONTEXT_OBJECT_TYPE_DEPOSIT||h))}function hasDeleteFilesPermission(e){return!!e&&(!!u||(e===o.CONTEXT_OBJECT_TYPE_ACCOUNT?u||m||v||T:e===o.CONTEXT_OBJECT_TYPE_LOAN||e===o.CONTEXT_OBJECT_TYPE_COLLATERAL?m:e===o.CONTEXT_OBJECT_TYPE_TREASURY?T:e!==o.CONTEXT_OBJECT_TYPE_DEPOSIT||v))}function hasReviewDocumentsPermission(e){return!!e&&(!!A||(e===o.CONTEXT_OBJECT_TYPE_ACCOUNT?A||I||R||N:e===o.CONTEXT_OBJECT_TYPE_LOAN||e===o.CONTEXT_OBJECT_TYPE_COLLATERAL?I:e===o.CONTEXT_OBJECT_TYPE_TREASURY?N:e!==o.CONTEXT_OBJECT_TYPE_DEPOSIT||R))}function hasPortalAdminPermission(e){return!!e&&(!!O||(e===o.CONTEXT_OBJECT_TYPE_ACCOUNT?L||w:e===o.CONTEXT_OBJECT_TYPE_LOAN?L:e===o.CONTEXT_OBJECT_TYPE_DEPOSIT&&w))}function hasRequiredRole(e){return checkListForString(e,c.userRoleName)}function checkListForString(e,t){return null==e||""===e||(!(0<(e=e.trim()).length)||(0<e.indexOf(";")?-1<e.toLowerCase().replace(/\s*;\s*/g,";").split(";").indexOf(t):e.toLowerCase().trim()===t))}function isESignLockedPlaceholder(e){var t=e?e.toUpperCase():"";return-1<[o.STATUS_SIGNATURE_CANCEL_PENDING.toUpperCase(),o.STATUS_SIGNATURE_EXCEPTION.toUpperCase(),o.STATUS_SIGNATURE_NEEDED.toUpperCase(),o.STATUS_SIGNATURE_PENDING.toUpperCase(),o.STATUS_SIGNATURE_READY_TO_TAG.toUpperCase(),o.STATUS_SIGNATURE_UPLOADING.toUpperCase()].indexOf(t)}}angular.module("app").service("permissionService",permissionService),permissionService.$inject=["PERMISSION_NAMES","PERMISSIONS","CONSTANTS","SYSTEM_PROPERTIES","universalDocManRemotingService","productPackageService","config","labels"]}()},function(e,t){!function(){"use strict";function placeholderService(o,a,i,r,l,t,n,c,s,d,u,f,e){var p={placeholders:[],placeholderApexTypeToApiNameMap:[],signedStatus:n.get().systemPropsMap.get(c.UNI_ESIGN_SIGNED_STATUSES),statusLists:[],statusTheme:[],uploadingToPlaceholder:{},isTranslated:null,buildImageUrls:function buildImageUrls(e){for(var t=a.defer(),n=0;n<Object.keys(e).length;n++){var r=e[Object.keys(e)[n]];r.file.previewUnavailable=!1,r.file.isPreviewSupported=p.isPreviewSupported(r.file.FileType),r.file.isPreviewSupported?(r.file.previewLink=s.CONTENT_PREVIEW_URL+r.file.Id,r.file.FileExtension&&-1!==d.indexOf(r.file.FileExtension.toLowerCase())?r.file.enlargedPreviewLink=s.CONTENT_ENLARGED_PREVIEW_URL_IMAGES_PART_1+r.file.Id+s.CONTENT_ENLARGED_PREVIEW_URL_IMAGES_PART_2:r.file.enlargedPreviewLink=s.CONTENT_ENLARGED_PREVIEW_URL+r.file.Id+s.CONTENT_ENLARGED_PREVIEW_URL_CONTENTID+r.file.Id+s.CONTENT_ENLARGED_PREVIEW_URL_CURRENTTIME+o.currentTime):r.file.previewUnavailable=!0,sendPreviewLinkURLRequest(r.file.previewLink),sendPreviewLinkURLRequest(r.file.enlargedPreviewLink)}return t.resolve(),t.promise},copyPlaceholderProperties:function copyPlaceholderProperties(e,t){{if(!e||!t)return!1;convertPropertyNamesFromCamelCase([e,t]);for(var n=c.WORKFLOW_UPDATE_FIELDS,r="",o=0;o<c.WORKFLOW_UPDATE_FIELDS_PREFIX_NEEDED.length;o++)n.push(window.UniDocMan.namespacePrefix+c.WORKFLOW_UPDATE_FIELDS_PREFIX_NEEDED[o]);if(null!=t.fieldSetSchema)for(var o=0;o<t.fieldSetSchema.length;o++){var a=t.fieldSetSchema[o].fieldPath;if(-1<n.indexOf(a)){r=a;break}}for(var i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(i===c.YEAR_KEY&&""!=e[i]&&""==t[i]&&t.fields&&(t.fields[r]=e[i]),t[i]=e[i])}},convertPropertyNamesFromCamelCase:convertPropertyNamesFromCamelCase,generateFileMetadata:function generateFileMetadata(e,t){e.fileName=t.name,e.fileSize=t.size,e.mimeType=t.type;var n={},r=c.FILE_NAME_CLASSIC,o=c.FILE_SIZE_CLASSIC,a=c.FILE_MIME_TYPE_CLASSIC;e.apexType==c.NAMESPACE_PREFIX+"."+c.CONTEXT_OBJECT_UNIVERSAL_DOC&&(r=c.FILE_NAME_UNIVERSAL,o=c.FILE_SIZE_UNIVERSAL,a=c.FILE_MIME_TYPE_UNIVERSAL);return n[p.placeholderApexTypeToApiNameMap[e.apexType]]={},n[p.placeholderApexTypeToApiNameMap[e.apexType]][r]=t.name,n[p.placeholderApexTypeToApiNameMap[e.apexType]][o]=t.size,n[p.placeholderApexTypeToApiNameMap[e.apexType]][a]=t.type,JSON.stringify(n)},isPreviewSupported:function isPreviewSupported(e){return-1!==s.PREVIEW_SUPPORTED_EXTENSIONS.indexOf(e)},loadRejectionReasonPicklistValues:function loadRejectionReasonPicklistValues(e){var t=a.defer(),n=e.indexOf(".")+1,r=c.PLACEHOLDER_APEX_TYPE_TO_API_NAME[e.substring(n,e.length)];return i.retrieveDependentPicklist(r,c.REJECTION_REASON_FIELD,UniDocMan.namespacePrefix+c.REJECTION_COMMENT_FIELD).then(function(e){var r=[],o=0;angular.forEach(e,function(e,t){var n={id:o,reason:t,comment:e[0]};r.push(n),o++}),t.resolve(r),l.picklistValues=r}),t.promise},placeholderHasFileOrExternal:function placeholderHasFileOrExternal(e){var t=!1;e&&(e.file&&void 0!==e.file.Id&&e.file.Id||e.documentStorageType&&e.isDocumentExternal)&&(t=!0);return t},populateStatusObjects:populateStatusObjects,prepareForUrls:function prepareForUrls(e){if(e&&0<e.length){p.convertPropertyNamesFromCamelCase(e);for(var t,n=[],r=0;r<e.length;r++)(t=e[r]).file&&t.file.FileType&&t.file.ParentId&&(n[t.file.ParentId]=t);if(0<Object.keys(n).length)return p.buildImageUrls(n)}var o=a.defer();return o.resolve(),o.promise},retrievePlaceholders:function retrievePlaceholders(){var t=a.defer();return a.all([i.retrieveDocuments(),i.getReviewStatusOptions()]).then(function(e){f.setLabels(e[1]),populateStatusObjects(),p.placeholders=e[0],p.convertPropertyNamesFromCamelCase(p.placeholders),p.placeholders&&angular.forEach(p.placeholders,function(e,t){p.setStatuses(e)}),t.resolve()}),t.promise},retrieveIsTranslated:function retrieveIsTranslated(){{if(null!==p.isTranslated)return new Promise(function(e,t){e()});var t=a.defer();return i.retrieveIsTranslated().then(function(e){p.isTranslated=e,t.resolve()}),t.promise}},sendPreviewLinkURLRequest:sendPreviewLinkURLRequest,setStatuses:function setStatuses(e){var t=!1;e.placeholderApprovalRoles&&!r.hasRequiredRole(e.placeholderApprovalRoles)||(t=!0);var n=strToUpper(e.status);f.getLabel(n)?e.statusTranslation=f.getLabel(n):e.statusTranslation=e.status;e.file&&e.file.Id||e.isDocumentExternal?n===strToUpper(c.STATUS_SIGNATURE_NEEDED)?setStatusListValue(e,u.E_SIGNATURE):n===strToUpper(c.STATUS_SIGNATURE_PENDING)?setStatusListValue(e,u.E_SIGNATURE_PENDING):n===strToUpper(c.STATUS_SIGNATURE_CANCEL_PENDING)?setStatusListValue(e,u.STATUS_SIGNATURE_CANCEL_PENDING):n===strToUpper(c.STATUS_SIGNATURE_EXCEPTION)?setStatusListValue(e,u.STATUS_SIGNATURE_EXCEPTION):n===strToUpper(c.STATUS_SIGNATURE_READY_TO_TAG)?setStatusListValue(e,c.STATUS_SIGNATURE_READY_TO_TAG):n===strToUpper(c.STATUS_SIGNATURE_UPLOADING)?setStatusListValue(e,c.STATUS_SIGNATURE_UPLOADING):e.status===p.signedStatus?setStatusListValue(e,t?u.HAS_FILE_SIGNED_AND_APPROVAL_ROLE:u.HAS_FILE_SIGNED):setStatusListValue(e,t?u.HAS_PLACEHOLDER_APPROVAL_ROLE:u.HAS_FILE):setStatusListValue(e,u.NO_FILE)},setStatusTheme:function setStatusTheme(e){var t=p.statusTheme[e.status];null==t&&(strToUpper(e.status)===strToUpper(c.STATUS_SIGNATURE_PENDING)?t=p.statusTheme[c.STATUS_SIGNATURE_PENDING]:strToUpper(e.status)===strToUpper(c.STATUS_SIGNATURE_NEEDED)?t=p.statusTheme[c.STATUS_SIGNATURE_NEEDED]:strToUpper(e.status)===strToUpper(c.STATUS_SIGNATURE_CANCEL_PENDING)?t=p.statusTheme[c.STATUS_SIGNATURE_CANCEL_PENDING]:strToUpper(e.status)===strToUpper(c.STATUS_SIGNATURE_EXCEPTION)&&(t=p.statusTheme[c.STATUS_SIGNATURE_EXCEPTION]),null==t&&(t=p.statusTheme[e.recordId]));return t},setVersionHistory:function setVersionHistory(t){var n=a.defer();t&&t.recordId?i.getDocumentVersions(t.recordId).then(function(e){t.versions=e,p.convertPropertyNamesFromCamelCase(t.versions),n.resolve()}):n.reject();return n.promise},strToUpper:strToUpper,translatableOrSpecialFieldType:function translatableOrSpecialFieldType(e){return(e=e.toLowerCase())==c.DATE_TYPE||e==c.DATETIME_TYPE||e==c.NUMBER_FIELD_TYPE||e==c.PERCENT_FIELD_TYPE||e==c.CURRENCY_FIELD_TYPE||e==c.URL_FIELD_TYPE},containsHyperlink:function containsHyperlink(e,t,n){if(e&&e.indexOf&&-1<e.indexOf("</a>")&&(t=(t=t.split("."))[t.length-1],n&&n.filter)){var r=n.filter(function(e){return e.fieldPath==t});if(r&&r.length&&1===r.length)return r[0].isFormula}return!1},uncheckAllPlaceholders:function uncheckAllPlaceholders(){o.$$childTail.$$childTail.toggleState=!1,angular.forEach(p.placeholders,function(e,t){r.hasRequiredViewerAccess(e)&&(e.isSelected=!1)})},getContentDocumentByVersion:i.getContentDocumentByVersion,setPreviewUrlCount:i.setPreviewUrlCount,getBulkUpdateScreenSectionData:i.getBulkUpdateScreenSectionData,updateRequirementRemote:i.updateRequirementRemote,unlinkRequirementFromPlaceholder:i.unlinkRequirementFromPlaceholder};return function setPlaceholderApexTypeToApiNameMap(){var e=c.NAMESPACE_PREFIX+c.PERIOD;p.placeholderApexTypeToApiNameMap[e+c.CONTEXT_OBJECT_ACCOUNT_DOC]=c.ACCOUNT_DOC_API_NAME,p.placeholderApexTypeToApiNameMap[e+c.CONTEXT_OBJECT_LOAN_DOC]=c.LOAN_DOC_API_NAME,p.placeholderApexTypeToApiNameMap[e+c.CONTEXT_OBJECT_UNIVERSAL_DOC]=c.DOCUMENT_PLACEHOLDER_API_NAME}(),p;function setStatusListValue(e,t){var n,r=!1;p.statusLists[t]&&(n=p.statusLists[t].length);for(var o=0;o<n;o++)if(e.status&&strToUpper(p.statusLists[t][o].name)===strToUpper(e.status)){r=!0;break}e.statusListValue=!r&&n?(p.statusLists[e.recordId]=p.statusLists[t].slice(),p.statusLists[e.recordId].push({name:e.status,theme:"slds-theme--shade",translation:f.getLabel(e.status)}),p.statusTheme[e.recordId]="slds-theme--shade",e.recordId):t}function populateStatusObjects(){var r={};r[c.STATUS_SIGNATURE_NEEDED]="slds-theme--warning",r[c.STATUS_SIGNATURE_PENDING]="slds-theme--info",r[c.STATUS_SIGNATURE_CANCEL_PENDING]="slds-theme--warning",r[c.STATUS_SIGNATURE_EXCEPTION]="slds-theme--error",r[p.signedStatus]="slds-theme--alt-inverse",r[c.STATUS_REVIEWED]="slds-theme--alt-inverse",r[c.STATUS_OPEN]="slds-theme--default openStatusIcon",r[c.STATUS_APPROVED]="slds-theme--success",r[c.STATUS_IN_FILE]="slds-theme--warning",r[c.STATUS_EXCEPTION]="slds-theme--error",r[c.STATUS_WAIVED]="",r[c.STATUS_SIGNATURE_UPLOADING]="uploading-status-theme",r[c.STATUS_SIGNATURE_READY_TO_TAG]="ready-to-tag-status-theme";var e,o={};o[u.NO_FILE]=[c.STATUS_EXCEPTION,c.STATUS_OPEN,c.STATUS_WAIVED],o[u.E_SIGNATURE]=[c.STATUS_EXCEPTION,c.STATUS_IN_FILE,c.STATUS_WAIVED],o[u.E_SIGNATURE_PENDING]=[c.STATUS_SIGNATURE_PENDING],o[u.STATUS_SIGNATURE_CANCEL_PENDING]=[c.STATUS_SIGNATURE_CANCEL_PENDING],o[u.STATUS_SIGNATURE_EXCEPTION]=[c.STATUS_SIGNATURE_EXCEPTION],o[u.HAS_FILE]=[c.STATUS_IN_FILE,c.STATUS_EXCEPTION,c.STATUS_REVIEWED,c.STATUS_WAIVED],o[u.HAS_FILE_SIGNED]=[p.signedStatus,c.STATUS_IN_FILE,c.STATUS_EXCEPTION,c.STATUS_REVIEWED,c.STATUS_WAIVED],o[u.HAS_FILE_SIGNED_AND_APPROVAL_ROLE]=[p.signedStatus,c.STATUS_APPROVED,c.STATUS_IN_FILE,c.STATUS_EXCEPTION,c.STATUS_REVIEWED,c.STATUS_WAIVED],o[u.HAS_PLACEHOLDER_APPROVAL_ROLE]=[c.STATUS_IN_FILE,c.STATUS_APPROVED,c.STATUS_EXCEPTION,c.STATUS_REVIEWED,c.STATUS_WAIVED],o[c.STATUS_SIGNATURE_UPLOADING]=[],o[c.STATUS_SIGNATURE_READY_TO_TAG]=[],e=n.get().contextObjectType===c.CONTEXT_OBJECT_TYPE_LOAN?n.get().loanDocumentReviewStatuses:n.get().contextObjectType===c.CONTEXT_OBJECT_TYPE_ACCOUNT?n.get().accountDocumentReviewStatuses:n.get().contextObjectType===c.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&t.selectedProductInProductPackage&&t.selectedProductInProductPackage.objectType===c.CONTEXT_OBJECT_TYPE_LOAN?n.get().loanDocumentReviewStatuses:n.get().universalDocumentReviewStatuses;var a=[];angular.forEach(e,function(e,t){c.DEFAULT_STATUSES.indexOf(e)<0&&(a.push({name:e,theme:"slds-theme--alt-inverse",translation:f.getLabel(e)}),r[e]="slds-theme--alt-inverse")}),0<a.length&&angular.forEach(o,function(n,e){angular.forEach(a,function(e,t){n.push(e.name)})}),Object.keys(o).forEach(function(n){p.statusLists[n]=[],Object.keys(r).forEach(function(e){if(p.statusTheme[e]=r[e],-1!=o[n].indexOf(e)){p.statusLists[n].push({name:e,theme:r[e],translation:f.getLabel(e)});var t=p.statusLists[n].slice(0);t.sort(function(e,t){return e.translation&&t.translation?e.translation.toLowerCase().localeCompare(t.translation.toLowerCase()):e.name.toLowerCase().localeCompare(t.name.toLowerCase())}),p.statusLists[n]=t}})})}function strToUpper(e){return null!=e?e.toUpperCase():""}function sendPreviewLinkURLRequest(e){jQuery("#docmanapp").append('<img id="hiddenImage" hidden="hidden" src="/>'),jQuery("#hiddenImage").attr("src",e),jQuery("#hiddenImage").remove()}function convertPropertyNamesFromCamelCase(e){angular.forEach(e,function(e){e.file&&e.file.recordType?mapObjectProperties(e.file):e.recordType&&mapObjectProperties(e)})}function mapObjectProperties(n){angular.forEach(e,function(e,t){n.hasOwnProperty(t)&&(Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(n,t)),delete n[t])})}}angular.module("app").service("placeholderService",placeholderService),placeholderService.$inject=["$rootScope","$q","universalDocManRemotingService","permissionService","picklistValueService","productPackageService","config","CONSTANTS","FILE","IMAGE_FILE_EXTENSIONS","STATUS_LIST","labels","DOCUMENT_VERSION_PROPERTY_MAP"]}()},function(e,t){!function(){"use strict";function productPackageService(t,n){var r={productPackageProducts:[],selectedProductInProductPackage:null,productPackageDocManWithoutProducts:!1,setProductPackageProducts:function setProductPackageProducts(e){e.LLC_BI__Product_Package__c&&(r.productPackageProducts=e.LLC_BI__Product_Package__c);t.get().includeProductPackageDocMan===n.STRING_VALUE_FALSE&&r.productPackageProducts.splice(0,1);0<r.productPackageProducts.length?(r.selectedProductInProductPackage=r.productPackageProducts[0],window.DocManId=e.LLC_BI__Product_Package__c[0].recordId,jQuery("#placeholderSearchBar").removeClass("col-xs-12"),jQuery("#placeholderSearchBar").addClass("col-xs-8")):r.productPackageDocManWithoutProducts=!0}};return r}angular.module("app").service("productPackageService",productPackageService),productPackageService.$inject=["config","CONSTANTS"]}()},function(e,t){!function(){"use strict";function documentManagerSearchFilter(e){return function(e,t){if(!t)return e;var n,r=[],o=(""+t).toLowerCase();return angular.forEach(e,function(e){(n=angular.copy(e)).apexType="",-1!==(""+JSON.stringify(n)).toLowerCase().indexOf(o)&&r.push(e)}),r}}angular.module("app").filter("portalEnabledFilter",function portalEnabledFilter(){return function(e,t){return e.filter(function(e){if(!t||e.portalEnabled)return!0})}}).filter("readyForEsignatureFilter",function readyForEsignatureFilter(){return function(e,t){return e.filter(function(e){if(!t||e.readyForEsignature)return!0})}}).filter("documentManagerSearchFilter",documentManagerSearchFilter).filter("categoriesFilter",function categoriesFilter(){return function(e,t){if(0===t.length)return e;var n=[];return angular.forEach(e,function(e){-1!==t.indexOf(e.category)&&n.push(e)}),n}}),documentManagerSearchFilter.$inject=["CONSTANTS"]}()},function(e,t){!function(){"use strict";function fileStagingService(e,n,r){var o=this;return o.service={stagedFiles:[],retrieveFileStagingPlaceholders:function retrieveFileStagingPlaceholders(){var t=e.defer();return n.retrieveFileStagingPlaceholders(function(e){r.prepareForUrls(e).then(function(){o.service.stagedFiles=e,t.resolve()})}),t.promise}},o.service}angular.module("app").service("fileStagingService",fileStagingService),fileStagingService.$inject=["$q","dataService","placeholderService"]}()},function(e,t){!function(){"use strict";function eSignatureService(a,c,s,r,i,o,l,d,u){return{sendESignatureDocuments:sendESignatureDocuments,cancelAllESignatureCollections:cancelAllESignatureCollections,cancelESignatureCollection:function cancelESignatureCollection(e,t){var n=d.ERROR,r=l.THEME_ERROR,o=l.ERROR_MSG;t[0]&&t[0].documentCollectionId&&(cancelCollectionAndUpdateStatus(t[0].documentCollectionId,t,e),n=d.SUCCESS,r=l.THEME_SUCCESS,o=l.E_SIGNATURE_CANCEL_SENT_SUCCESS_MSG);a.$broadcast(c.SET_TOAST,{type:n,theme:r,body:o})},confirmCancelAllESignatureCollections:function confirmCancelAllESignatureCollections(t){a.alert={isRendered:!0,theme:l.THEME_WARNING,label:{heading:l.E_SIGNATURE_CANCEL_LABEL,message:l.E_SIGNATURE_CONFIRM_CANCEL,confirm:l.E_SIGNATURE_YES_CANCEL_BTN,cancel:l.E_SIGNATURE_NO_CANCEL_BTN},confirm:function(e){if(a.alert.isRendered=!1,e)return cancelAllESignatureCollections(t)}}},resendESignature:function resendESignature(t){a.alert={isRendered:!0,theme:l.THEME_WARNING,label:{heading:l.E_SIGNATURE_SEND_LABEL,message:l.E_SIGNATURE_CONFIRM_RESEND,confirm:l.OK_BTN,cancel:l.CANCEL_BTN},confirm:function(e){a.alert.isRendered=!1,e&&sendESignatureDocuments(t).then(function(e){var t=d.ERROR,n=l.THEME_ERROR,r=l.ERROR_MSG;e&&(t=d.SUCCESS,n=l.THEME_SUCCESS,r=l.E_SIGNATURE_SENT_SUCCESS_MSG),a.$broadcast(c.SET_TOAST,{type:t,theme:n,body:r})})}}},getESignatureNonActiveStatuses:function getESignatureNonActiveStatuses(){return[c.STATUS_SIGNATURE_CANCEL_PENDING.toUpperCase(),c.STATUS_SIGNATURE_EXCEPTION.toUpperCase(),c.STATUS_SIGNATURE_PENDING.toUpperCase(),c.STATUS_SIGNED.toUpperCase()]}};function sendESignatureDocuments(t,n){for(var e,r=[],o=u.defer(),a=!1,i=0;i<t.length;i++){var l=t[i];l.isSelected&&l.status&&l.status.toLowerCase()===c.STATUS_SIGNATURE_NEEDED.toLowerCase()&&(r.push(l.documentStoreId),a=l.docPrepPrepared,e=l.documentCollectionId)}return a?s.createCollection(r).then(function(e){e?o=sendCollection(o,t,e,n):o.reject(c.ERROR_EVENT)}):e?o=sendCollection(o,t,e,n):o.reject(c.ERROR_EVENT),o.promise}function sendCollection(t,n,r,e){return s.sendCollection(r,e).then(function(e){e?(angular.forEach(n,function(e,t){e.isSelected&&e.status&&e.status.toLowerCase()===c.STATUS_SIGNATURE_NEEDED.toLowerCase()&&(e.documentCollectionId=r)}),t.resolve(c.SENT)):t.reject(c.ERROR_EVENT)}),t}function cancelCollectionAndUpdateStatus(e,t,n){n.controller&&(n.controller.showEsignatureCollectionDetailModal=!1),s.cancelSignatureCollection(e).then(function(e){e&&angular.forEach(t,function(t){o.isESigPendingCanceledException(t.status)&&angular.forEach(e,function(e){t.documentStoreId===e&&r.performStatusUpdate(n,t,c.STATUS_SIGNATURE_CANCEL_PENDING)})})})}function cancelAllESignatureCollections(o){var t=[];angular.forEach(i.placeholders,function(e){t.push(e.documentStoreId)}),s.getCollectionIds(t).then(function(e){var t=d.ERROR,n=l.THEME_ERROR,r=l.ERROR_MSG;e&&(angular.forEach(e,function(e){cancelCollectionAndUpdateStatus(e,i.placeholders,o)}),t=d.SUCCESS,n=l.THEME_SUCCESS,r=l.E_SIGNATURE_CANCEL_SENT_SUCCESS_MSG),a.$broadcast(c.SET_TOAST,{type:t,theme:n,body:r})})}}angular.module("app").service("eSignatureService",eSignatureService),eSignatureService.$inject=["$rootScope","CONSTANTS","universalDocManRemotingService","commonService","placeholderService","permissionService","ALERT_DIALOG","TOAST_TYPES","$q"]}()},function(e,t){!function(){"use strict";function eSignatureNotificationService(o){var a=this;a.pendingUpdates=0,a.updateThrottle,function registerESignatureNotification(){UniDocMan.esignatureNotification||(UniDocMan.esignatureNotification=function(e){var t=!1;if(e&&e.data&&e.data.sobject)for(var n=e.data.sobject.LLC_BI__Document_Store__c,r=0;r<o.placeholders.length;r++)o.placeholders[r].documentStoreId===n&&(t=!0);t&&function throttleRetrievePlaceholders(){a.pendingUpdates?(a.pendingUpdates++,clearTimeout(a.updateThrottle),a.updateThrottle=setTimeout(o.retrievePlaceholders().then(function(){a.pendingUpdates--}),500)):(a.pendingUpdates++,o.retrievePlaceholders().then(function(){a.pendingUpdates--}))}()})}()}angular.module("app").service("eSignatureNotificationService",eSignatureNotificationService),eSignatureNotificationService.$inject=["placeholderService"]}()},function(e,t){!function(){"use strict";function eSignaturePreparationService(t,o,r,n,a){return{fireErrorMessage:fireErrorMessage,validateDocuments:validateDocuments,validateDocumentsForSend:function validateDocumentsForSend(e){return validateDocuments(e)&&function validateCollectionIds(e){var t={};if(e)for(var n=0;n<e.length;n++)checkStatusForSend(e[n],t),Object.keys(t).length||checkCollectionForSend(e[0],e[n],t);if(Object.keys(t).length)return fireErrorMessage(t),!1;return!0}(e)},getReadyForTaggingCollectionId:function getReadyForTaggingCollectionId(e){var t=[o.STATUS_SIGNATURE_NEEDED.toLowerCase(),o.STATUS_SIGNATURE_READY_TO_TAG.toLowerCase()],n=e.filter(function(e){return e.isSelected&&e.documentCollectionId&&!e.docPrepPrepared&&-1!==t.indexOf(e.status.toLowerCase())});if(!n||0===n.length)return"";var r=n[0].documentCollectionId;return 0===e.filter(function(e){return e.documentCollectionId&&e.documentCollectionId===r&&-1===t.indexOf(e.status.toLowerCase())||e.isSelected&&!e.documentCollectionId}).length?r:""}};function validateDocuments(e){for(var t={},n=!1,r=0;r<e.length;r++){var o=e[r];o.isSelected&&(n=!0,checkFileSize(o,t),checkStatus(o,t),checkExtension(o,t),checkDocPrepPrepared(o,t))}return Object.keys(t).length?(fireErrorMessage(t),!1):n}function checkFileSize(e,t){e.fileSize>=a.ESIGNATURE_MAX_FILE_SIZE&&(t[e.name]||(t[e.name]=[]),t[e.name].push(r.E_SIGNATURE_FILE_SIZE_EXCEEDED))}function checkStatus(e,t){var n=[o.STATUS_IN_FILE.toLowerCase(),o.STATUS_SIGNATURE_NEEDED.toLowerCase(),o.STATUS_SIGNATURE_READY_TO_TAG.toLowerCase()];e.status&&-1!==n.indexOf(e.status.toLowerCase())||(t[e.name]||(t[e.name]=[]),t[e.name].push(r.E_SIGNATURE_STATUS_ERROR))}function checkExtension(e,t){var n=o.ESIGNATURE_ALLOWED_FILE_TYPES;e.file.FileExtension&&-1!==n.indexOf(e.file.FileExtension.toLowerCase())||(t[e.name]||(t[e.name]=[]),t[e.name].push(r.E_SIGNATURE_FILE_TYPE_ERROR))}function checkDocPrepPrepared(e,t){e.docPrepPrepared&&(t[e.name]||(t[e.name]=[]),t[e.name].push(r.E_SIGNATURE_DOC_PREP_ERROR))}function checkStatusForSend(e,t){e.status&&e.status.toLowerCase()===o.STATUS_SIGNATURE_NEEDED.toLowerCase()||(t[e.name]||(t[e.name]=[]),t[e.name].push(r.E_SIGNATURE_SEND_STATUS_ERROR))}function checkCollectionForSend(e,t,n){e.documentCollectionId&&t.documentCollectionId&&e.documentCollectionId===t.documentCollectionId||(n[t.name]||(n[t.name]=[]),n[t.name].push(r.E_Signature_Different_Collection_Error))}function fireErrorMessage(e){t.$broadcast(o.SET_TOAST,{type:n.ERROR,theme:r.THEME_ERROR,body:function formatErrorMessage(e){for(var t="",n=Object.keys(e),r=0;r<n.length;r++){for(var o=e[n[r]],a=0;a<o.length;a++)t+=0===a?n[r]+": "+o[a]:" "+o[a]+" ";n[r+1]&&(t+="\n\n")}return t}(e)})}}angular.module("app").service("eSignaturePreparationService",eSignaturePreparationService),eSignaturePreparationService.$inject=["$rootScope","CONSTANTS","ALERT_DIALOG","TOAST_TYPES","FILE"]}()},function(e,t){!function(){"use strict";function browserDetectService(e,t){return{detectIE:function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");if(0<r)return parseInt(e.substring(r+5,e.indexOf(".",r)),10);return!1}}}angular.module("app").service("browserDetectService",browserDetectService),browserDetectService.$inject=["CONSTANTS","$q"]}()},function(e,t){!function(){"use strict";angular.module("app").provider("docManConfig",function Config(){var n=this;function replaceAll(e,t,n){return e.replace(new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function htmlDecodeRecursive(e){if("string"==typeof e||e instanceof String)return function htmlDecode(e){e=replaceAll(e=replaceAll(e=replaceAll(e,"\\'","'"),"\\&quot;",'"'),"\\\\","\\");var n={amp:"&",lt:"<",gt:">",quot:'"'};return e=e.replace(/&(#(?:x[0-9a-f]+|\d+)|[a-z]+);?/gi,function(e,t){return"#"===t[0]?String.fromCharCode("x"===t[1].toLowerCase()?parseInt(t.substr(2),16):parseInt(t.substr(1),10)):n.hasOwnProperty(t)?n[t]:e})}(e);for(var t in e)e.hasOwnProperty(t)&&(e[t]=htmlDecodeRecursive(e[t]));return e}n.config={},n.$get=function(e){return{get:function(){return n.config}}},n.set=function(e){n.config=angular.merge(n.config,e)},n.setHtmlEncoded=function(e){for(var t in e)e.hasOwnProperty(t)&&(n.config[t]=htmlDecodeRecursive(e[t]))}})}()},function(e,t){!function(){"use strict";angular.module("app").provider("labels",function Labels(){var o=this;o.labels={},o.$get=function(){return{getLabels:function(){return o.labels},getLabel:function(e,t){var n=e.replace(/-|\s/g,"_").toUpperCase(),r=o.labels[n];return null==r&&(r=e),1==t&&(r=r.toUpperCase()),r},setLabels:function(e){return angular.merge(o.labels,e)}}},o.setLabels=function(e){o.labels=angular.merge(o.labels,e)}})}()},function(e,t){!function(){"use strict";function PlaceholderController(l,c,r,e,s,d,t,u,n,o,f,p,E,g,a,i,h,m,T,v,S,P,_,C,D,A,I,N,R,O,L,w,U,M,y,b,F,k){var x=this;function initializeDynamicVariables(){x.defaultEsignatureMessage="",x.isLoading=!0,x.reverse=!1,x.selectedNewOption=a.ADD_NEW,x.isNewPlaceholderShown=!1,x.newPlaceholder={},x.selectedPlaceholder=null,x.rightClickedPlaceholder=null,x.imagePreviewLoadingInterval=null,x.enlargedPreviewLoadingInterval=null,x.searchText="",x.productSearchText="",x.selectedLeftNavHeader=x.leftNavAllDocumentsHeader,x.eSignPlaceholderSelected=!1,f.draggingFromRightNav=!1,x.hasEditPermissions=x.permissionService.hasEditDetailsPermission(x.configValues.contextObjectType),x.hasNamePermission=x.permissionService.hasPermission(x.configValues.contextObjectType,m.UNI_CREATE_PLACEHOLDER_NAME),x.showRelationshipLink=!1,x.showCollateralLink=!1,x.allPlaceholdersSelected=!1,x.placeholderFilterValue,x.enlargedPreviewLink="",x.picklistValueChanged=!1,x.hasBulkUpdate=x.configValues.systemPropsMap.get(v.BULK_UPDATE_ENABLED),x.labels=b.getLabels()}function selectedPlaceholderCount(){var n=0,r=!1;return x.eSignPlaceholderSelected=!1,angular.forEach(I.placeholders,function(e,t){e.isSelected&&(n+=1,e.status&&e.status.toLowerCase()===p.STATUS_SIGNATURE_NEEDED.toLowerCase()||(r=!0))}),x.eSignPlaceholderSelected=!r&&0<n,n}function filterByCategories(e){null!=e&&x.selectCategory(e),I.uncheckAllPlaceholders(),jQuery("#accordion .collapse.in").collapse("hide"),x.isCategoriesOpen=!0,x.placeholderFilterValue=void 0,x.isFilterByPortalEnabled=!1,x.isFilterByReadyForEsignature=!1,x.isFilterByCategories=!0}function retrievePlaceholders(){I.retrievePlaceholders().then(function(){I.placeholders&&I.placeholders.length&&(angular.forEach(I.placeholders,function(e,t){x.permissionService.hasRequiredViewerAccess(e)||(e.file&&""!==e.file||(e.file={}),e.file.previewUnavailable=!0)}),updatePlaceholderCount(),t.detectIE()?x.placeHolderPaginationLimit=30:x.placeHolderPaginationLimit=x.totalPlaceholdersCount),x.isLoading=!1})}function setLegalEntities(){P.retrieveLegalEntities(window.DocManId).then(function(e){x.relationshipOptions=[{recordId:"",accountId:"",name:b.getLabels().NONE_OPTION}].concat(e)})}function setCategories(){d.retrieveCategories(function(e){if(x.docTypeOptions=[{recordId:"",name:b.getLabels().NONE_OPTION}],e)for(var t in e)e.hasOwnProperty(t)&&x.docTypeOptions.push({recordId:t,name:e[t]})})}function setArchivedFiles(){d.retrieveArchivedDocumentsWithAttachments(function(e){I.prepareForUrls(e).then(function(){f.archivedFiles=e,x.isLoaded=!0})})}function determineContextObjectType(){x.isLoanDocMan=!1,x.isAccountDocMan=!1,x.isUniversalDocMan=!1,x.contextObjectType===p.CONTEXT_OBJECT_TYPE_LOAN?x.isLoanDocMan=!0:x.contextObjectType===p.CONTEXT_OBJECT_TYPE_ACCOUNT?x.isAccountDocMan=!0:x.contextObjectType===p.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE?(x.isUniversalDocMan=!0,null!=y.selectedProductInProductPackage&&(y.selectedProductInProductPackage.objectType===p.CONTEXT_OBJECT_TYPE_LOAN?(x.isUniversalDocMan=!1,x.isLoanDocMan=!0):y.selectedProductInProductPackage.objectType===p.CONTEXT_OBJECT_TYPE_ACCOUNT&&(x.isUniversalDocMan=!1,x.isAccountDocMan=!0))):x.isUniversalDocMan=!0}function markPlaceholderAsTrash(){P.removeFileFromPlaceholders([x.placeholderToBeDeleted.recordId]).then(function(e){f.archivedFiles=e[0],I.unlinkRequirementFromPlaceholder([x.placeholderToBeDeleted.recordId]),I.convertPropertyNamesFromCamelCase(f.archivedFiles),P.archivePlaceholderFromFileStaging(x.placeholderToBeDeleted.recordId).then(function(){var e=I.placeholders.indexOf(x.placeholderToBeDeleted);I.placeholders.splice(e,1),x.placeholderToBeDeleted=null,x.showDeleteModal=!1,updatePlaceholderCount()})})}function configureDynamicColumn(){var e=x.contextObjectType;e===p.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&null!==y.selectedProductInProductPackage&&(e=y.selectedProductInProductPackage.objectType,f.$broadcast(p.CHANGED_PRODUCT_PACKAGE_PRODUCT,e)),P.getConfigurableColumns(e).then(function(e){x.configurableColumns=JSON.parse(e),x.columnHeaders=[{label:c.NAME,name:c.NAME.toLowerCase(),columnStyle:"col-xs-6 col-sm-2 col-lg-3 docman-header-column",sortReverseDefault:!1}];var o=0;angular.forEach(x.configurableColumns,function(e,t){var n=-1<p.SORT_REVERSE_DEFAULT_TYPES.indexOf(e.typeApex);-1<p.CONVERT_TO_RELATIONSHIP_LABEL.indexOf(e.label.toLowerCase())&&(e.label=c.RELATIONSHIP),-1<p.CONVERT_TO_CATEGORY_LABEL.indexOf(e.label.toLowerCase())&&(e.label=c.CATEGORY);var r={label:e.label,name:"configurableColumns["+o+"].sortValue",fieldPath:e.fieldPath,columnStyle:"hidden-xs col-sm-2 docman-header-column truncate",sortReverseDefault:n};x.columnHeaders.push(r),o++})}),x.showRelationshipLink=e!==p.CONTEXT_OBJECT_TYPE_ACCOUNT&&e!==p.CONTEXT_OBJECT_TYPE_COLLATERAL,x.showCollateralLink=e===p.CONTEXT_OBJECT_TYPE_LOAN,e===p.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&x.configValues.includeProductPackageDocMan===p.STRING_VALUE_TRUE&&angular.forEach(y.productPackageProducts,function(e,t){e.objectType!==p.CONTEXT_OBJECT_TYPE_LOAN||(x.showCollateralLink=!0)})}function sortOrder(e,t){x.columnSortHeader===e?x.reverse=!x.reverse:(x.reverse=t,x.secondarySortHeader=x.secondarySortHeader||x.columnSortHeader!==e?x.columnSortHeader:c.NAME.toLowerCase()),x.columnSortHeader=e}function renderPreview(e,t,n){var r,o=t===s.CONTENT_PREVIEW_LARGE,a=t===s.CONTENT_PREVIEW_THUMBNAIL;if(x.permissionService.hasRequiredViewerAccess(e)){if(a)e.isDocumentExternal&&(e.file&&""!==e.file||(e.file={}),e.file.previewLink=UniDocMan.IMAGE_PREVIEW_NOT_AVAILABLE_EXTERNAL,x.enlargedPreviewLink=""),r=100,x.imagePreviewLoadingInterval=setIntervalFunction(s.CONTENT_PREVIEW_THUMBNAIL,s.CONTENT_PREVIEW_URL+e.file.Id,r);else if(o&&!e.isDocumentExternal){x.selectedVersion||(x.selectedVersion=e.file);var i=s.CONTENT_ENLARGED_PREVIEW_URL+x.selectedVersion.Id;i+=void 0!==n?"&page="+n:"",r=1e3,x.enlargedPreviewLoadingInterval=setIntervalFunction(s.CONTENT_PREVIEW_LARGE,i,r)}}else a?x.selectedPlaceholder.file.previewLink=UniDocMan.IMAGE_PREVIEW_NOT_AVAILABLE_FALLBACK:o&&(x.selectedVersion=x.selectedVersion||e.file,x.selectedVersion.enlargedPreviewLink=UniDocMan.IMAGE_EXPANDED_PREVIEW_NOT_AVAILABLE)}function setIntervalFunction(t,n,r){var o=0;return window.setInterval(function(){o++;var e=x.enlargedPreviewLink;l.$apply(function(){t===s.CONTENT_PREVIEW_THUMBNAIL?x.selectedPlaceholder.file.previewLink="":t===s.CONTENT_PREVIEW_LARGE&&(x.enlargedPreviewLink="")}),l.$apply(function(){r<o?t===s.CONTENT_PREVIEW_THUMBNAIL?(x.selectedPlaceholder.file.previewLink=UniDocMan.IMAGE_PREVIEW_NOT_AVAILABLE_FALLBACK,x.enlargedPreviewLink=UniDocMan.IMAGE_EXPANDED_PREVIEW_NOT_AVAILABLE,x.selectedPlaceholder.file.previewUnavailable=!0):t===s.CONTENT_PREVIEW_LARGE&&(x.enlargedPreviewLink=UniDocMan.IMAGE_EXPANDED_PREVIEW_NOT_AVAILABLE):t===s.CONTENT_PREVIEW_THUMBNAIL?(x.selectedPlaceholder.file.previewLink=n,""!==e&&(x.enlargedPreviewLink=e)):t===s.CONTENT_PREVIEW_LARGE&&(x.enlargedPreviewLink=n)})},100)}function renderModal(t){P.getESignatureDefaultMessage().then(function(e){!function setSelected(e){for(var t=[],n=0;n<e.length;n++)e[n].isSelected=!0,t.push(e[n].recordId);for(n=0;n<I.placeholders.length;n++)-1===t.indexOf(I.placeholders[n].recordId)&&(I.placeholders[n].isSelected=!1)}(t),x.selectedPlaceholders=t,x.defaultEsignatureMessage=e,x.showEsignatureMessageModal=!0,x.workingModal=!1})}function savePlaceholderSuccess(e,t,n){I.copyPlaceholderProperties(e[0],t),t.isEditing=!1,L.clear(),x.toggleButtonDisable(),t.file?t.file.previewLoaded=!0:t.file={previewLoaded:!0,previewLink:""},x.loadPlaceholderDetails(t,500,!0),n&&buildChatterCommentForChangedFields(t,function(e){(0<n.length||0<e.length)&&(t.newComment=n+"  "+e,x.addChatterComment(t)),x.retrieveChatterComments(t)}),I.updateRequirementRemote([t.recordId]),x.selectedPlaceholder.beforeFields=t.fields}function savePlaceholderFailure(e){L.setMessage({type:L.messageTypes.error,text:e,context:"modal"}),x.toggleButtonDisable()}function buildChatterCommentForChangedFields(e,t){var n="",r=null,o=null,a=null,i=null;a=-1<e.apexType.indexOf("LoanDocument")||-1<e.apexType.indexOf("AccountDocument")?(o=u.formatMillisecondsToUTCDate(e.fields.LLC_BI__date__c),r=u.formatMillisecondsToUTCDate(x.selectedPlaceholder.beforeFields.LLC_BI__date__c),i=u.formatMillisecondsToUTCDate(e.fields.LLC_BI__exceptionDate__c),u.formatMillisecondsToUTCDate(x.selectedPlaceholder.beforeFields.LLC_BI__exceptionDate__c)):(o=u.formatMillisecondsToUTCDate(e.fields.LLC_BI__Date__c),r=u.formatMillisecondsToUTCDate(x.selectedPlaceholder.beforeFields.LLC_BI__Date__c),i=u.formatMillisecondsToUTCDate(e.fields.LLC_BI__Exception_Date__c),u.formatMillisecondsToUTCDate(x.selectedPlaceholder.beforeFields.LLC_BI__Exception_Date__c)),!r&&o?n=b.getLabels().DATE+" "+o+" "+b.getLabels().WAS_ADDED:r&&!o?n=b.getLabels().DATE+" "+r+" "+b.getLabels().WAS_REMOVED+p.PERIOD:r&&o&&r!=o&&(n=b.getLabels().DATE_CHANGED_FROM+" "+r+" "+b.getLabels().TO_LABEL+" "+o+p.PERIOD),!a&&i?n+=" "+b.getLabels().EXCEPTION_DATE+" "+i+" "+b.getLabels().WAS_ADDED:a&&!i?n+=" "+b.getLabels().EXCEPTION_DATE+" "+a+" "+b.getLabels().WAS_REMOVED+p.PERIOD:a&&i&&a!=i&&(n+=" "+b.getLabels().EXCEPTION_DATE_CHANGED_FROM+" "+a+" "+b.getLabels().TO_LABEL+" "+i+p.PERIOD),t(n)}function resetToast(){x.toast="",x.toastSubHeading="",x.downloadSubHeading1="",x.downloadSubHeading2="",x.downloadLinkValue="",x.downloadVersionId=""}function retrieveChatterComments(n){null!=n&&d.retrieveChatterComments(n.recordId,function(t){l.$apply(function(){if(n.comments=t,n.comments&&0<n.comments.length)for(var e=0;e<n.comments.length;e++)n.comments[e].body=String(n.comments[e].body).replace(/<[^>\<]+>/gm,"")})})}function hideNewDialog(){x.isNewPlaceholderShown=!1,x.newPlaceholder={}}function validateNewPlaceholderAndSave(){var r=!1;x.fieldSetAddSchema.forEach(function(e,t){var n=x.newPlaceholder[e.fieldPath];!0!==e.required||null!=n&&""!==n||(r=!0),"date"!==e.type||r||isNaN(n)||(x.newPlaceholder[e.fieldPath]=n)}),r?(x.toggleButtonDisable(),x.newPlaceholder.validationErr=!0):(x.newPlaceholder.validationErr=!1,d.addNewPlaceholder(x.newPlaceholder,function(e){l.$apply(function(){hideNewDialog(),I.setStatuses(e),I.placeholders.push(e),updatePlaceholderCount(),x.toggleButtonDisable()})},function(e,t){x.toggleButtonDisable(),x.newPlaceholder.err=!0}))}function updatePlaceholderCount(){x.totalPlaceholdersCount=I.placeholders.length,x.placeholderPagination()}function renderPreviewPage(e){clearInterval(x.enlargedPreviewLoadingInterval),x.isLoadingLargeImage=!0,renderPreview(e,s.CONTENT_PREVIEW_LARGE,x.selectedVersion.currentPreviewPage-1)}function getOffsetDatetime(e){var t=new Date(e);return e&&!isNaN(t.getTime())&&window.LifeCycle.Internationalize?window.LifeCycle.Internationalize.timeZoneUtil&&window.LifeCycle.Internationalize.timeZoneUtil.applyAggregateOffset?new Date(window.LifeCycle.Internationalize.timeZoneUtil.applyAggregateOffset("add",t.getTime())):t:null}function hasEditAccess(e,t){return x.permissionService.hasRequiredViewerAccess(e)&&x.permissionService.hasEditAfterApprovalPermission(m.UNI_EDIT_DETAILS,e.status,t)}function showErrorToast(e){showToast(e,T.ERROR,E.THEME_ERROR)}function showSuccessToast(e){showToast(e,T.SUCCESS,E.THEME_SUCCESS)}function showToast(e,t,n){x.toast=e,x.toastType=t,x.toastIcon=n}x.connection,x.columnSortHeader=c.NAME.toLowerCase(),x.secondarySortHeader="",x.leftNavAllDocumentsHeader=e.ALL_DOCUMENTS,x.selectedLeftNavHeader=x.leftNavAllDocumentsHeader,x.relationshipOptions=[],x.docTypeOptions=[],x.docTypeLabel=i.LABEL,x.showDeleteModal=!1,x.showDeleteMultipleModal=!1,x.workingModal=!1,x.showVersionsModal=!1,x.showEsignatureCollectionDetailModal=!1,x.showEsignatureCancelDetails=!1,x.isFilterByCategories=!1,x.showPortalOptionsModal=!1,x.viewRequestDocumentsModal=!1,x.requestDocumentsEditMode=!1,x.placeholderToBeDeleted=null,x.placeholdersToBeDeleted=[],x.placeholdersInCollection=[],x.displayPreviewBackground=!1,x.showContextMenu=!1,x.hasEditPermissions=!1,x.hasNamePermission=!1,x.showAddNewDropdown=!1,x.performingAjax=!1,function initializeToast(){x.toastStack=[{toastIcon:E.THEME_SUCCESS}],x.toastType=T.MESSAGE,x.toastIcon=E.THEME_WARNING,resetToast()}(),x.showEsignatureMessageModal=!1,x.showEditDetailsModal=!1,x.statusLists={},x.statusTheme={},x.fieldSetAddSchema=null,x.contextObjectType="",x.placeholderNames=[],x.loanTeamMembers=[],x.selectedCategory="",x.isLoanDocMan=!1,x.isAccountDocMan=!1,x.isUniversalDocMan=!1,x.showPortalRejectionModal=!1,x.versioningEnabled=!0,x.rejectionReasons=[],x.configValues=w.get(),x.configurableColumns=[],x.buttonDisabled=!1,x.showCancelPortalModal=!1,x.placeholdersToBeCancelled=[],x.isTranslated=!1,x.selectedPlaceholder,x.selectedVersion,x.isCategoriesOpen=!1,x.documentManagerFileSizeLimit="",x.bulkUpdateRecords=[],x.selectedCategories=[],x.esignUploadInProgress=!1,x.selectedPlaceholders=[],x.eSignatureService=N,x.defaultDownloadService=_,x.permissionService=h,x.placeholderService=I,x.commonService=u,x.productPackageService=y,x.uploadServiceData=n,x.config=w,x.CONSTANTS=p,x.navigator=F,x.fieldRestrictions=[],x.picklistLabels={},x.addNewPlaceholder=function addNewPlaceholder(){x.toggleButtonDisable(),null==x.fieldSetAdd?P.retrievePlaceholderFieldSetAdd(window.DocManId).then(function(e){x.fieldSetAddSchema=JSON.parse(e),validateNewPlaceholderAndSave()}):validateNewPlaceholderAndSave()},x.addChatterComment=function addChatterComment(e){x.performingAjax=!0,e.newComment&&d.addChatterComment(e.recordId,e.newComment,function(){e.newComment="",x.performingAjax=!1,x.retrieveChatterComments(e)})},x.addFile=function addFile(){jQuery("#rightClickAddFile-"+x.rightClickedPlaceholder.recordId+":hidden").trigger("click")},x.buildChatterCommentForChangedFields=buildChatterCommentForChangedFields,x.buildImageURL=function buildImageURL(e){if(e.file){var t=e;(e=[])[t.file.ParentId]=t}f.currentTime=(new Date).getTime(),I.buildImageUrls(e).then(function(){x.selectedPlaceholder&&x.loadPlaceholderDetails(x.selectedPlaceholder,500)})},x.canPrepareForESignature=function canPrepareForESignature(){return UniDocMan.ESignaturePluginActive&&x.permissionService.hasPrepareForESignature()},x.cancelDelete=function cancelDelete(){x.showDeleteModal=!1,x.showDeleteMultipleModal=!1,x.placeholderToBeDeleted=null,x.placeholdersToBeDeleted=[]},x.cancelEditDetails=function cancelEditDetails(){x.selectedPlaceholder&&(x.selectedPlaceholder.isEditing=!1,x.showEditDetailsModal=!1,x.selectedPlaceholder.fields=jQuery.extend(!0,{},x.selectedPlaceholder.beforeFields),x.selectedPlaceholder.validationErr=!1,x.selectedPlaceholder.err=!1,L.clear())},x.setMultiPicklistValue=function setMultiPicklistValue(e,t){var n=e.getAttribute("data-field"),r=e.getAttribute("data-id"),o=t.fields[n];if(n){var a=jQuery("select[data-id="+r+"]"),i=jQuery("img.picklistArrowRight[data-id="+r+"]"),l=a[0],c=a[1];if(o&&l){for(var s,d=o.split(";"),u=0,f=c.options.length;u<f;u++)s=c.options[u],-1!=d.indexOf(s.innerHTML)&&(s.selected="selected");i.click()}}},x.updateMultiPicklistValue=function updateMultiPicklistValue(e,t){for(var n,r=[],o=e&&e.options,a=e.getAttribute("data-field"),i=e.getAttribute("data-id"),l=0,c=o.length;l<c;l++)(n=o[l]).selected&&r.push(n.value);i=="update-picklist-"+a?t.fields[a]=r.join(";"):i=="add-new-picklist-"+a&&(t[a]=r.join(";"))},x.cancelPortalOptionsUpdate=function cancelPortalOptionsUpdate(){x.showPortalOptionsModal=!1},x.cancelPortalRejectionModal=function cancelPortalRejectionModal(){x.showPortalRejectionModal=!1,x.selectedPlaceholder.portalRejectionComment=x.originalRejectionComment,x.selectedPlaceholder.portalRejectionReason=x.originalRejectionReason},x.cancelOverwrite=function cancelOverwrite(){f.$broadcast(p.OVERWRITE_CONFIRM,!1),x.showOverwriteModal=!1,jQuery(".docman-placeholder-row").removeClass("fileHover")},x.closeExpandedPreview=function closeExpandedPreview(){clearInterval(x.enlargedPreviewLoadingInterval),x.displayPreviewBackground=!1,x.isLoadingNewPage=!1,x.enlargedPreviewLink=""},x.configureDynamicColumn=configureDynamicColumn,x.closeModal=function closeModal(){U.url(g.DEFAULT_ROUTE)},x.resetToast=resetToast,x.changeLeftNavFilter=function changeLeftNavFilter(e){x.selectedLeftNavHeader=e},x.confirmDelete=function confirmDelete(){markPlaceholderAsTrash(x.placeholderToBeDeleted)},x.confirmDeleteMultiple=function confirmDeleteMultiple(){x.workingModal=!0;var n=[];angular.forEach(x.placeholdersToBeDeleted,function(e,t){n.push(e.recordId)}),x.showDeleteMultipleModal=!1,I.unlinkRequirementFromPlaceholder(n),P.removeFileFromPlaceholders(n).then(function(){P.archivePlaceholdersFromFileStaging(n).then(function(){angular.forEach(x.placeholdersToBeDeleted,function(e,t){var n=I.placeholders.indexOf(e);I.placeholders.splice(n,1)}),x.updatePlaceholderCount(),x.setArchivedFiles(),x.workingModal=!1,x.placeholdersToBeDeleted=[]})})},x.confirmOverwrite=function confirmOverwrite(){f.$broadcast(p.OVERWRITE_CONFIRM,!0),x.showOverwriteModal=!1},x.copyFileLink=function copyFileLink(e){var t=U.$$host;e.file.RecordType===s.ATTACHMENT?t+=s.ATTACHMENT_DOWNLOAD_URL+e.file.Id:t+=s.CONTENT_DOWNLOAD_URL+e.file.Id;u.copyToClipboard(t)},x.deletePlaceholder=function deletePlaceholder(e){x.placeholderToBeDeleted=e,x.showDeleteModal=!0},x.deletePlaceholders=function deletePlaceholders(){angular.forEach(I.placeholders,function(e,t){e.isSelected&&x.placeholdersToBeDeleted.push(e)}),x.placeholdersToBeDeleted.length&&(x.showDeleteMultipleModal=!0)},x.downloadFile=function downloadFile(e){if(void 0!==C.before&&typeof C.before===p.FUNCTION&&void 0!==C.after&&typeof C.after===p.FUNCTION&&void 0!==C.execute&&typeof C.execute===p.FUNCTION&&!0===C.before(e.recordId,e.isDocumentExternal,e.documentStorageType))return void C.execute().then(function(e){C.after(e)},function(e){C.after(e)});_.executeDownload(e)},x.retrieveAndProcessData=function retrieveAndProcessData(){configureDynamicColumn(),retrievePlaceholders(),determineContextObjectType(),setLegalEntities(),setCategories(),setArchivedFiles(),D.retrieveFileStagingPlaceholders().then(function(){}),sortOrder(c.NAME.toLowerCase(),!1)},x.downloadVersion=function downloadVersion(e,t,n){if(e.isExternalReference)window.open(e.externalDownloadUrl);else if(t){var r=x.selectedPlaceholder.name;e!==x.selectedPlaceholder.versions[0]&&(r+=p.DASH+e.versionNumber);var o=s.CONTENT_DOWNLOAD_URL,a=!0;e.RecordType===s.ATTACHMENT&&(o=s.ATTACHMENT_DOWNLOAD_URL,a=!1);var i=_.getDownloadLink(o,e.Id,n);_.updateFileTitleAndDownload(e.Id,r,a,i,e.Title)}else _.downloadVersion(e,n)},x.doubleClickPlaceholderRow=function doubleClickPlaceholderRow(e){jQuery(p.HASH+e.recordId).collapse("toggle")},x.duplicatePlaceholder=function duplicatePlaceholder(e){{if(null==e)return{errorMessage:b.getLabels().PLACEHOLDER_OBJECT_NULL};d.duplicatePlaceholder(e.recordId,function(e){l.$apply(function(){e.file="",I.setStatuses(e),I.placeholders.push(e),updatePlaceholderCount()})})}},x.contextMenuEditDetails=function contextMenuEditDetails(e){e===x.selectedPlaceholder&&x.selectedPlaceholder.isOpen?x.showEditDetails(e):(e.rightClickEditDetails=!0,jQuery(p.HASH+e.recordId).collapse("show"))},x.filterByPortalEnabled=function filterByPortalEnabled(){I.uncheckAllPlaceholders(),jQuery("#accordion .collapse.in").collapse("hide"),x.isCategoriesOpen=!1,x.placeholderFilterValue=void 0,x.isFilterByReadyForEsignature=!1,x.isFilterByPortalEnabled=!0,x.isFilterByCategories=!1,x.selectedCategories=[]},x.filterByReadyForEsignature=function filterByReadyForEsignature(){I.uncheckAllPlaceholders(),jQuery("#accordion .collapse.in").collapse("hide"),x.isCategoriesOpen=!1,x.placeholderFilterValue=void 0,x.isFilterByPortalEnabled=!1,x.isFilterByReadyForEsignature=!0,x.isFilterByCategories=!1,x.selectedCategories=[]},x.filterByCategories=filterByCategories,x.formatContentSize=function formatContentSize(e){return null==e||isNaN(e)||""===e?"":1<=e/1024e6?"("+Math.round(10*e/1024e6)/10+" GB)":1<=e/1024e3?"("+Math.round(10*e/1024e3)/10+" MB)":1<=e/1024?"("+Math.round(e/1024)+" KB)":e/1024<1?"("+e+" Bytes)":""},x.hideNewDialog=hideNewDialog,x.initializeDynamicVariables=initializeDynamicVariables,x.downloadMultipleFiles=function downloadMultipleFiles(){_.downloadMultipleFiles(I.placeholders)},x.initializePortalRejectionModal=function initializePortalRejectionModal(t){x.showPortalRejectionModal=!0,I.loadRejectionReasonPicklistValues(t.apexType).then(function(e){x.rejectionReasons=e,x.selectedPlaceholder=t,x.originalRejectionReason=x.selectedPlaceholder.portalRejectionReason,x.originalRejectionComment=x.selectedPlaceholder.portalRejectionComment})},x.isCategoryField=function isCategoryField(e){return e===i.PATH||e===i.PATH2},x.isDocTypeField=function isDocTypeField(e){return e.toLowerCase()===(window.UniDocMan.namespacePrefix+p.DOC_TYPE_FIELD).toLowerCase()||e.toLowerCase()===(p.DEFAULT_NAMESPACE+p.DOC_TYPE_FIELD).toLowerCase()},x.isLegalEntityField=function isLegalEntityField(e){return e===window.UniDocMan.namespacePrefix+p.ENTITY_LOOKUP_FIELD},x.isRelationshipField=function isRelationshipField(e){return e===window.UniDocMan.namespacePrefix+p.RELATIONSHIP_LOOKUP_FIELD},x.isSortedByStatus=function isSortedByStatus(){return angular.isFunction(x.columnSortHeader)},x.loadPlaceholderDetails=function loadPlaceholderDetails(e,t,n){clearInterval(x.imagePreviewLoadingInterval),!n&&x.selectedPlaceholder&&x.selectedPlaceholder.beforeFields&&delete x.selectedPlaceholder.beforeFields;x.selectedPlaceholder=e,n&&I.convertPropertyNamesFromCamelCase([x.selectedPlaceholder]);retrieveChatterComments(e),x.retrieveLoanTeamMembers(),I.placeholderHasFileOrExternal(x.selectedPlaceholder)?void 0!==x.selectedPlaceholder.file.RecordType&&x.selectedPlaceholder.file.RecordType===r.FILE?void 0===x.selectedPlaceholder.file.ParentId||x.selectedPlaceholder.file.previewLoaded||(!function isPreviewSupported(e){return-1!==["PDF","WORD_X","WORD","EXCEL_X","EXCEL","POWER_POINT_X","POWER_POINT","PNG","JPEG","JPG","BMP","TEXT"].indexOf(e)}(e.file.FileType)?o(function(){l.$apply(function(){x.selectedPlaceholder.file?(x.selectedPlaceholder.file.previewLoaded=!0,x.selectedPlaceholder.file.previewUnavailable=!0):x.selectedPlaceholder.file={previewLoaded:!0,previewLink:""},x.selectedPlaceholder.file.previewLink=UniDocMan.IMAGE_PREVIEW_NOT_AVAILABLE_TYPE})},t):renderPreview(x.selectedPlaceholder,s.CONTENT_PREVIEW_THUMBNAIL)):x.selectedPlaceholder.isDocumentExternal&&x.selectedPlaceholder.documentStorageType?renderPreview(x.selectedPlaceholder,s.CONTENT_PREVIEW_THUMBNAIL):o(function(){l.$apply(function(){x.selectedPlaceholder.file?(x.selectedPlaceholder.file.previewLoaded=!0,x.selectedPlaceholder.file.previewUnavailable=!0):x.selectedPlaceholder.file={previewLoaded:!0},x.selectedPlaceholder.file.previewLink=UniDocMan.IMAGE_PREVIEW_NOT_AVAILABLE_FALLBACK})},t):o(function(){l.$apply(function(){x.selectedPlaceholder.file?(x.selectedPlaceholder.file.previewLoaded=!0,x.selectedPlaceholder.file.previewUnavailable=!0):x.selectedPlaceholder.file={previewLoaded:!0},x.selectedPlaceholder.file.previewLink=""})},t);d.retrievePlaceholderWithFields(x.selectedPlaceholder.recordId,function(i){d.retrievePlaceholderFieldSet(x.selectedPlaceholder.recordId,function(a){l.$apply(function(){x.selectedPlaceholder.fieldSetSchema=JSON.parse(a),x.selectedPlaceholder.fields=i;for(var e=0;e<x.selectedPlaceholder.fieldSetSchema.length;e++){var t=x.selectedPlaceholder.fieldSetSchema[e],n=t.fieldPath;if("DATETIME"===t.typeApex)x.selectedPlaceholder.fields[n]?x.selectedPlaceholder.fields[n]=date:x.selectedPlaceholder.fields[n]=null;else if("PICKLIST"===t.typeApex&&t.options){x.picklistLabels[n]={};for(var r=0;r<t.options.length;r++){var o=t.options[r];x.picklistLabels[n][o.value]=o.label}}}x.selectedPlaceholder.beforeFields=jQuery.extend(!0,{},x.selectedPlaceholder.fields),x.selectedPlaceholder.rightClickEditDetails&&(x.selectedPlaceholder.rightClickEditDetails=!1,x.showEditDetails(x.selectedPlaceholder))})})})},x.markPlaceholderAsTrash=markPlaceholderAsTrash,x.passedExceptionDate=function passedExceptionDate(e,t){if(-1!==p.EXCEPTION_DATE_FIELDS.indexOf(e)&&t.fields&&t.fields[e]&&null!=t.fields[e]){var n=new Date(t.fields[e]);if(n<=new Date)return!0}return!1},x.placeholderFilter=function placeholderFilter(e){I.uncheckAllPlaceholders(),jQuery("#accordion .collapse.in").collapse("hide"),x.placeholderFilterValue=e,x.isFilterByPortalEnabled=!1,x.isFilterByReadyForEsignature=!1,x.isFilterByCategories=!1,x.selectedCategories=[]},x.productPackageProductChange=function productPackageProductChange(e){y.selectedProductInProductPackage=e,window.DocManId=y.selectedProductInProductPackage.recordId,initializeDynamicVariables(),configureDynamicColumn(),retrievePlaceholders(),determineContextObjectType(),I.populateStatusObjects(),setLegalEntities(),setCategories(),setArchivedFiles(),D.retrieveFileStagingPlaceholders().then(function(){})},x.renderPreview=renderPreview,x.retrieveChatterComments=retrieveChatterComments,x.retrieveLoanTeamMembers=function retrieveLoanTeamMembers(){0===x.loanTeamMembers.length&&x.isLoanDocMan&&P.retrieveLoanTeamMembers().then(function(e){e&&0<e.length&&(x.loanTeamMembers=e)})},x.retrieveOwnerName=function retrieveOwnerName(e){for(var t=0;t<x.loanTeamMembers.length;t++)if(x.loanTeamMembers[t].userId===e)return x.loanTeamMembers[t].name;return b.getLabels().NONE},x.retrievePlaceholderNames=function retrievePlaceholderNames(e){x.selectedCategory=e,x.performingAjax=!0,P.retrievePlaceholderNames(x.selectedCategory).then(function(e){x.selectedPlaceholder&&x.selectedPlaceholder.fieldSetSchema&&u.formatDateFieldsForInput(x.selectedPlaceholder,x.selectedPlaceholder.fieldSetSchema),e&&0<e.length&&(x.placeholderNames=e),x.performingAjax=!1})},x.retrievePlaceholders=retrievePlaceholders,x.savePlaceholderPortalFields=function savePlaceholderPortalFields(t){x.toggleButtonDisable();var e={},n=[];for(var r in p.PORTAL_FIELDS){var o=p.PORTAL_FIELDS[r];null!=t.fields[o]&&(e[o]=t.fields[o])}if(t.fields){for(var o in e){var a=e[o];null==a||""===a?(n.push(o),delete e[o],-1!==o.indexOf("Portal_Doc_Name__c")&&(t.portalDocName=t.name)):-1!==o.indexOf("Portal_Doc_Name__c")&&(t.portalDocName=a)}P.savePlaceholderPortalData(t.recordId,e,n).then(function(e){x.showPortalOptionsModal=!1,savePlaceholderSuccess(e,t)},function(e){savePlaceholderFailure(e)})}},x.savePlaceholderWithFields=function savePlaceholderWithFields(t){x.toggleButtonDisable();var n=function determineChangeOfStatus(e){var t="",n=new Date,r=null,o="";o=-1<e.apexType.indexOf("LoanDocument")||-1<e.apexType.indexOf("AccountDocument")?(r=new Date(parseInt(e.fields.LLC_BI__exceptionDate__c)),"LLC_BI__reviewStatus__c"):(r=new Date(parseInt(e.fields.LLC_BI__Exception_Date__c)),"LLC_BI__Review_Status__c");e.file||(e.file={previewLoaded:!1,previewLink:""});if(r<=n&&x.selectedPlaceholder.status!=p.STATUS_EXCEPTION)e.fields[o]=p.STATUS_EXCEPTION,t+=" "+b.getLabels().STATUS_CHANGED_FROM+" "+b.getLabel(x.selectedPlaceholder.status,1)+" "+b.getLabels().TO_LABEL+" "+b.getLabel(p.STATUS_EXCEPTION,1)+p.PERIOD,x.selectedPlaceholder.status=p.STATUS_EXCEPTION,x.selectedPlaceholder.statusTranslation=b.getLabel(p.STATUS_EXCEPTION);else if(n<r&&x.selectedPlaceholder.status==p.STATUS_EXCEPTION){var a=p.STATUS_OPEN;(e.file.Title||e.file.Id)&&(a=p.STATUS_IN_FILE),e.fields[o]=a,t+=" "+b.getLabels().STATUS_CHANGED_FROM+" "+b.getLabel(p.STATUS_EXCEPTION,1)+" "+b.getLabels().TO_LABEL+" "+b.getLabel(a,1)+p.PERIOD,x.selectedPlaceholder.status=a,x.selectedPlaceholder.statusTranslation=b.getLabel(a)}return t}(t),r=function chooseFieldsToBeSaved(e){var t={};for(var n in e.fields)null==e.beforeFields[n]||e.beforeFields[n]!==e.fields[n]?t[n]=e.fields[n]:p.REQUIRED_FIELDS_TO_BE_SAVED.some(function(e){return n===e})&&(t[n]=e.fields[n]);return t}(t),o=[];if(t.fields){var e=!1;for(var a in t.fieldSetSchema){var i=t.fieldSetSchema[a],l=t.fields.hasOwnProperty(i.fieldPath)?t.fields[i.fieldPath]:"";if(!0===i.required&&(null==l||""===l)){e=!0,x.selectedPlaceholder.validationErr=!0,x.toggleButtonDisable();break}"DATE"===i.typeApex&&r.hasOwnProperty(i.fieldPath)&&(null==t.fields[i.fieldPath]||""===t.fields[i.fieldPath]?r[i.fieldPath]=null:r[i.fieldPath]=parseInt(t.fields[i.fieldPath])),"DATETIME"===i.typeApex&&r.hasOwnProperty(i.fieldPath)&&(null==t.fields[i.fieldPath]?r[i.fieldPath]=null:r[i.fieldPath]=parseInt(t.fields[i.fieldPath]))}e||(angular.forEach(r,function(e,t){null!==e&&""!==e||(o.push(t),delete r[t])}),P.savePlaceholderData(t.recordId,r,o).then(function(e){x.showEditDetailsModal=!1,x.selectedPlaceholder.validationErr=!1,savePlaceholderSuccess(e,t,n)},function(e){savePlaceholderFailure(e)}))}},x.savePortalRejectionReasons=function savePortalRejectionReasons(e){x.performingAjax=!0;var t=p.REJECTION_REASON_FIELD,n=p.REJECTION_COMMENT_FIELD,r={};r[t]=e.portalRejectionReason,r[n]=e.portalRejectionComment,P.savePortalRejectionReasons(e.recordId,r).then(function(){x.performingAjax=!1,x.showPortalRejectionModal=!1,f.$broadcast(p.SAVED_PORTAL_REJECTION_REASON,e,b.getLabel(p.STATUS_EXCEPTION,1))})},x.searchTextCollapse=function searchTextCollapse(){2<x.searchText.length&&(I.uncheckAllPlaceholders(),jQuery("#accordion .collapse.in").collapse("hide"))},x.selectCategory=function selectCategory(e){if(x.selectedCategories.includes(e)){var t=x.selectedCategories.indexOf(e);x.selectedCategories.splice(t,1)}else x.selectedCategories.push(e);0===x.selectedCategories.length&&filterByCategories()},x.confirmCancelAllESignatureCollections=function confirmCancelAllESignatureCollections(){N.confirmCancelAllESignatureCollections(l)},x.cancelESignatureCollection=function cancelESignatureCollection(){N.cancelESignatureCollection(l,x.placeholdersInCollection)},x.placeholderPagination=function placeholderPagination(){x.placeHolderPaginationLimit+10<x.totalPlaceholdersCount?x.placeHolderPaginationLimit+=10:x.placeHolderPaginationLimit=x.totalPlaceholdersCount},x.retrieveIsTranslated=function retrieveIsTranslated(){x.performingAjax=!0,I.retrieveIsTranslated().then(function(){null!==I.isTranslated&&(x.isTranslated=I.isTranslated),x.performingAjax=!1})},x.selectedPlaceholderCount=selectedPlaceholderCount,x.sendESignatures=function sendESignatures(){return!0===x.eSignPlaceholderSelected&&(N.sendESignatureDocuments(x.selectedPlaceholders,x.defaultEsignatureMessage).then(function(e){e?(showSuccessToast(E.E_SIGNATURE_SENT_SUCCESS_MSG),angular.forEach(x.selectedPlaceholders,function(e,t){e.isSelected&&e.status.toLowerCase()===p.STATUS_SIGNATURE_NEEDED.toLowerCase()&&u.performStatusUpdate(l,e,p.STATUS_SIGNATURE_PENDING)})):showErrorToast(E.ERROR_MSG),x.showEsignatureMessageModal=!1}),!0)},x.setShowContextMenu=function setShowContextMenu(e){x.showContextMenu=e},x.showEditDetails=function showEditDetails(e){x.selectedPlaceholder.isEditing=!0,x.showEditDetailsModal=!0,x.retrievePlaceholderNames(function getPlaceholderCategory(e){{if(e.fields&&e.fields.hasOwnProperty(i.ID_PATH))return e.fields[i.ID_PATH];if(e.fields&&e.fields.hasOwnProperty(i.ID_PATH2))return e.fields[i.ID_PATH2]}}(e)),x.retrieveIsTranslated()},x.showEsignatureMessage=function showEsignatureMessage(){if(!0===x.eSignPlaceholderSelected){x.workingModal=!0;var t=function getSelectedPlaceholders(){for(var e=[],t=0;t<I.placeholders.length;t++)I.placeholders[t].isSelected&&e.push(I.placeholders[t]);return e}();!function placeholdersContainCollectionId(e){for(var t=0;t<e.length;t++)if(e[t].documentCollectionId)return!0;return!1}(t)?renderModal(t):(t=function findAllCollectionIdPlaceholders(e){for(var t=[],n=0;n<I.placeholders.length;n++)I.placeholders[n].documentCollectionId&&e[0].documentCollectionId&&I.placeholders[n].documentCollectionId===e[0].documentCollectionId&&t.push(I.placeholders[n]);return t}(t),O.validateDocumentsForSend(t)?function isCollectionActive(e){var t=M.defer();return P.retrieveActiveDocumentCollections([e]).then(function(e){e&&!e.length?(showErrorToast(E.E_SIGNATURE_INACTIVE_COLLECTION_ID),t.resolve(!1)):t.resolve(!0)}),t.promise}(t[0].documentCollectionId).then(function(e){e?renderModal(t):x.workingModal=!1}):x.workingModal=!1)}},x.showESignatureCollectionDetails=function showESignatureCollectionDetails(n,e){x.placeholdersInCollection=[],x.showEsignatureCancelDetails=e,n.documentCollectionId&&angular.forEach(I.placeholders,function(e,t){e.documentCollectionId&&e.documentCollectionId==n.documentCollectionId&&x.placeholdersInCollection.push(e)});x.showEsignatureCollectionDetailModal=!0},x.showExpandedPreview=function showExpandedPreview(t,n){if(x.selectedVersion=t.file,n&&t.versions){var e=t.versions.filter(function(e){return e.Id===n});e&&0<e.length&&(x.selectedVersion=e[0])}t.isExternalReference?window.open(t.externalPreviewUrl):(x.connection=x.connection?x.connection:new jsforce.Connection({accessToken:d.sessionId}),x.expandedFileTitle=x.selectedVersion.fileName,x.displayPreviewBackground=!0,x.isLoadingLargeImage=!0,void(x.selectedVersion.currentPreviewPage=0)!==x.selectedVersion.previewUrlCount&&-1<x.selectedVersion.previewUrlCount?renderAvailablePreviews(t,x.selectedVersion.previewUrlCount):I.getContentDocumentByVersion(x.selectedVersion.Id,t.currentAttachmentId).then(function(e){var t="/connect/files/"+e.Id+"/previews/svg";return x.connection.chatter.resource(t)}).then(function(e){if("Available"===e.status)return renderAvailablePreviews(t,e.previewUrlCount),I.setPreviewUrlCount(x.selectedVersion.Id,e.previewUrlCount);renderWithoutPreviews(e.status)},function handlePreviewError(e){renderWithoutPreviews()}).catch(function handleSetPreviewError(e){}));function renderWithoutPreviews(e){x.enlargedPreviewLink=void 0===e||"NotAvailable"===e?(x.processErrorOccurred=!0,UniDocMan.IMAGE_EXPANDED_PREVIEW_NOT_AVAILABLE):UniDocMan.IMAGE_PREVIEW_GENERATING}function renderAvailablePreviews(e,t){x.selectedVersion.currentPreviewPage=1,x.selectedVersion.previewUrlCount=t,renderPreview(e,s.CONTENT_PREVIEW_LARGE)}},x.changePageBy=function changePageBy(e){var t=x.selectedVersion.currentPreviewPage+e;(function inPreviewRange(e){var t=x.selectedVersion.previewUrlCount;return 0<e==e<=t})(t)&&(x.selectedVersion.currentPreviewPage=t,renderPreviewPage(x.selectedPlaceholder))},x.onKeyDown=function onKeyDown(e){13===e.originalEvent.keyCode&&renderPreviewPage(x.selectedPlaceholder)},x.showMoreComments=function showMoreComments(e){e.commentsLimit+=p.MORE_COMMENTS},x.showNewDialog=function showNewDialog(){x.retrieveLoanTeamMembers(),x.isNewPlaceholderShown=!0},x.showModal=function showModal(e){U.url(e)},x.showRequestDocumentsModal=function showRequestDocumentsModal(){selectedPlaceholderCount()&&(x.viewRequestDocumentsModal=!0)},x.requestPortalDocuments=function requestPortalDocuments(){x.toggleButtonDisable(),x.requestDocumentsEditMode=!1;for(var o=selectedPlaceholderCount(),e=[],t={},n=0;n<I.placeholders.length;n++){var r=I.placeholders[n];r.isSelected&&(t={recordId:r.recordId,portalDocName:r.portalDocName,portalDocDescription:r.portalDocDescription},e.push(t))}0<e.length?P.requestPortalDocuments(e).then(function(e){for(var t=0;t<I.placeholders.length;t++){var n=I.placeholders[t];n.isSelected&&(n.portalEnabled=!0)}I.uncheckAllPlaceholders(),x.toggleButtonDisable(),x.viewRequestDocumentsModal=!1;var r=o+" ";showSuccessToast(1===o?r+x.labels.PORTAL_DOC_REQUEST_SINGULAR:r+x.labels.PORTAL_DOC_REQUEST_PLURAL)}):(x.toggleButtonDisable(),x.viewRequestDocumentsModal=!1,showErrorToast(x.labels.PORTAL_DOC_REQUEST_NONE))},x.cancelPortalDocuments=function cancelPortalDocuments(){0<x.placeholdersToBeCancelled.length&&P.cancelPortalRequests(x.placeholdersToBeCancelled).then(function(e){for(var t=0;t<I.placeholders.length;t++)I.placeholders[t].isSelected&&(I.placeholders[t].portalEnabled=!1);I.uncheckAllPlaceholders(),x.hideCancelPortalModal()})},x.cancelPortalModal=function cancelPortalModal(){x.placeholdersToBeCancelled=[];for(var e=0;e<I.placeholders.length;e++)I.placeholders[e].isSelected&&!0===I.placeholders[e].portalEnabled&&x.placeholdersToBeCancelled.push(I.placeholders[e].recordId);if(0===x.placeholdersToBeCancelled.length)return void showErrorToast(x.labels.PORTAL_DOC_BULK_CANCEL_NONE);x.showCancelPortalModal=!0},x.hideCancelPortalModal=function hideCancelPortalModal(){x.showCancelPortalModal=!1},x.showPortalOptions=function showPortalOptions(){x.showPortalOptionsModal=!0},x.showVersionModal=function showVersionModal(){I.setVersionHistory(x.selectedPlaceholder).then(function(){angular.forEach(x.selectedPlaceholder.versions,function(e,t){I.sendPreviewLinkURLRequest(e.previewLink)}),x.showVersionsModal=!0})},x.sortByStatus=function sortByStatus(){angular.isFunction(x.columnSortHeader)?x.reverse=!x.reverse:x.reverse=!1;x.columnSortHeader=function(e){switch(e.statusTranslation){case b.getLabel(p.STATUS_EXCEPTION):return 1;case b.getLabel(p.STATUS_IN_FILE):return 2;case b.getLabel(p.STATUS_REVIEWED):return 3;case b.getLabel(p.STATUS_APPROVED):return 4;case b.getLabel(p.STATUS_OPEN):return 5;case b.getLabel(p.STATUS_WAIVED):return 6}}},x.sortOrder=sortOrder,x.toggleButtonDisable=function toggleButtonDisable(){x.buttonDisabled=!x.buttonDisabled},x.updatePortalRejectionComment=function updatePortalRejectionComment(){x.selectedPlaceholder&&angular.forEach(x.rejectionReasons,function(e,t){e.reason===x.selectedPlaceholder.portalRejectionReason&&(x.selectedPlaceholder.portalRejectionComment=e.comment)})},x.updatePlaceholderCount=updatePlaceholderCount,x.setArchivedFiles=setArchivedFiles,x.nameInPlaceholderNames=function nameInPlaceholderNames(e){return-1<x.placeholderNames.indexOf(e)},x.formatCommentDate=function formatCommentDate(e){var t=new Date(e);if(!e||isNaN(t.getTime())||!window.LifeCycle.Internationalize)return e;var n=window.LifeCycle.Internationalize.format(t,"d"),r=window.LifeCycle.Internationalize.format(t,"t");return n+" "+r},x.formatDatetime=function formatDatetime(e){var t=getOffsetDatetime(e);return t?window.LifeCycle.Internationalize.format(t,"d")+" "+window.LifeCycle.Internationalize.format(t,"t"):e},x.formatDatetimeAsDate=function formatDatetimeAsDate(e){var t=getOffsetDatetime(e);return t?window.LifeCycle.Internationalize.format(t,"d"):e},x.showBulkUpdateModal=function showBulkUpdateModal(){var e=function getSelectedPlaceholderIds(){for(var e=[],t=[],n=0;n<I.placeholders.length;n++){var r=I.placeholders[n];r.isSelected&&(hasEditAccess(r,!0)||t.push(r),e.push(r.recordId))}if(0<t.length)return function showBulkEditAfterApprovalError(e){for(var t="",n=0;n<e.length;n++)t+="\n\t "+e[n].name;showErrorToast(x.labels.BULK_UPDATE_AFTER_APPROVAL_DENIED+t)}(t),[];return e}();if(0===e.length)return;x.isLoading=!0,I.getBulkUpdateScreenSectionData(window.DocManId,e).then(function(e){x.isLoading=!1,e&&e.summaryScreenSectionModel&&(x.fieldGridScreenSectionId=e.updateScreenSectionId,x.bulkUpdateRecords=e.summaryScreenSectionModel.records,x.fieldRestrictions=JSON.parse(e.fieldRestrictions))})},x.onBulkUpdateClosed=function onBulkUpdateClosed(){x.bulkUpdateRecords=[]},x.onBulkUpdateComplete=function onBulkUpdateComplete(){x.isLoading=!0;for(var e=[],t=0;t<x.bulkUpdateRecords.length;t++)e.push(x.bulkUpdateRecords[t].recordId);I.updateRequirementRemote(e),retrievePlaceholders(),I.uncheckAllPlaceholders()},x.prepareForESig=function prepareForESig(){if(O.validateDocuments(I.placeholders)){x.workingModal=!0;var n=O.getReadyForTaggingCollectionId(I.placeholders);if(n&&""!==n)(function getESignatureTaggingUrl(e){return P.getESignatureTaggingUrl(e)})(n).then(function(e){if(x.workingModal=!1,e&&""!==e){var t=window.location.origin+x.navigator.resolvePageURL(e);t+="&documentCollectionId="+n,window.open(t)}});else{x.workingModal=!1,x.esignUploadInProgress=!0;var r=u.getDocStoresFromSelectedPlaceholders(I.placeholders);(function getActiveDocumentCollections(){for(var t=M.defer(),e=[],n=0;n<I.placeholders.length;n++){var r=I.placeholders[n],o=r.documentCollectionId&&e&&e.indexOf(r.documentCollectionId)<0;o&&r.status&&((a=r.status)&&-1===N.getESignatureNonActiveStatuses().indexOf(a.toUpperCase()))&&e.push(r.documentCollectionId)}var a;return 0!==e.length?P.retrieveActiveDocumentCollections(e).then(function(e){t.resolve(e)}):t.resolve([]),t.promise})().then(function(e){0===e.length?function createCollection(e){return P.createCollection(e,!0)}(r).then(function(t){(function createVendorCollection(e,t){return P.createVendorCollection(e,t)})(r,t).then(function(e){retrievePlaceholders()}).catch(function(e){P.deleteCollection(t).then(function(){retrievePlaceholders()})})}):function associateDocsToCollection(e,t){return P.associateDocsToCollection(e,t)}(r,e[0]).then(function(e){retrievePlaceholders()})})}}},x.hasEditAccess=hasEditAccess,x.bulkScreenSectionPostLoad=function bulkScreenSectionPostLoad(e,t,n){var r=k.getPropertyBagObject(x.fieldGridScreenSectionId);Object.keys(r).forEach(function(e){var t=r[e];if(function isRestrictedField(e){return 0!==x.fieldRestrictions.length&&e&&e.hasOwnProperty("fieldName")&&-1<Object.keys(x.fieldRestrictions).indexOf(e.fieldName)}(t)){var n=x.fieldRestrictions[t.fieldName];null===n?t.isVisible=!1:t.options&&(t.options=t.options.filter(function(e){return-1===n.indexOf(e.value)}))}})},x.isESigDetailAvailable=function isESigDetailAvailable(e){return e&&e.status.toUpperCase()!==p.STATUS_SIGNATURE_CANCEL_PENDING.toUpperCase()&&h.isESignLockedPlaceholder(e.status)&&e.documentCollectionId&&x.hasEditPermissions},x.init=function init(e,t,n,r,o,a,i){c.CATEGORY=e,c.EXCEPTION_DATE=t,c.LAST_MODIFIED_DATE=n,c.NAME=r,c.RELATIONSHIP=o,c.STATUS=a,c.YEAR=i,initializeDynamicVariables(),function activate(){U.url(g.DEFAULT_ROUTE),x.contextObjectType=x.configValues.contextObjectType,x.contextObjectType&&"LLC_BI__Product_Package__c"==x.contextObjectType?d.configureContextObject(function(e){e&&(e.LLC_BI__Product_Package__c?y.setProductPackageProducts(e):e.Contact&&(window.DocManId=e.Contact)),x.retrieveAndProcessData()}):x.retrieveAndProcessData();jQuery("#placeholderTable").on("show.bs.collapse",function(e){jQuery("#accordion .collapse.in").collapse("hide");for(var t=0;t<x.totalPlaceholdersCount;t++)if(I.placeholders[t].recordId===e.target.id){I.placeholders[t].isOpen=!0,x.loadPlaceholderDetails(I.placeholders[t],0);break}}),x.documentManagerFileSizeLimit=w.get().systemPropsMap.get(v.UNI_DOCMAN_FILE_SIZE_LIMIT),f.allowedFileExtensions=w.get().systemPropsMap.get(v.ALLOWED_FILE_EXTENSIONS),f.allowedFileExtensions=angular.isString(f.allowedFileExtensions)?f.allowedFileExtensions.split(","):"",jQuery("#placeholderTable").on("hide.bs.collapse",function(e){if(!e.target.getAttribute("uni-date-picker"))for(var t=0;t<x.totalPlaceholdersCount;t++)if(I.placeholders[t].recordId===e.target.id){I.placeholders[t].isOpen=!1,I.placeholders[t].newComment="";break}}),jQuery("#productDropDownSearch").click(function(e){e.stopPropagation()}),jQuery("#accordion").on("shown.bs.collapse",function(e){!function scrollTo(e){var t=angular.element(e.target.parentElement),n=angular.element("#accordion");n.animate({scrollTop:n.scrollTop()+t.position().top-35},400)}(e)}),jQuery(window).on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),jQuery(window).on("drop",function(e){e.preventDefault(),e.stopPropagation(),f.draggingFromRightNav=!1}),f.$on(p.SHOW_OVERWRITE_MODAL,function(e,t){x.showOverwriteModal=!0}),f.$on(p.SET_TOAST,function(e,t){showToast(t.body,t.type,t.theme),t.link&&(x.downloadSubHeading1=E.DOWNLOAD_SUBHEADING_1,x.downloadVersionId=t.link,x.downloadLinkValue=E.DOWNLOAD_LINK_VALUE,x.downloadSubHeading2=E.DOWNLOAD_SUBHEADING_2)})}()}}angular.module("app").controller("PlaceholderController",PlaceholderController),PlaceholderController.$inject=["$scope","COLUMNS","FILE_RECORD_TYPES","LEFT_NAV_FILTER_HEADERS","FILE","dataService","browserDetectService","commonService","uploadService","$timeout","$rootScope","CONSTANTS","ALERT_DIALOG","ROUTES","NEW_OPTIONS","CATEGORY_FIELD","permissionService","PERMISSIONS","TOAST_TYPES","SYSTEM_PROPERTIES","IMAGE_FILE_EXTENSIONS","universalDocManRemotingService","defaultDownloadService","downloadService","fileStagingService","picklistValueService","placeholderService","eSignatureService","eSignatureNotificationService","eSignaturePreparationService","messageService","config","$location","$q","productPackageService","labels","navigator","screenSection"]}()},function(e,t){!function(){"use strict";function StatusController(r,e,o,a,i,n){this.updatePlaceholderStatus=function updatePlaceholderStatus(e,t){t===n.STATUS_EXCEPTION&&e.portalEnabled?r.controller.initializePortalRejectionModal(e):o.performStatusUpdate(r,e,t)},this.canOpenStatusDropdown=function canOpenStatusDropdown(e){var t=a.hasEditAfterApprovalPermission("UNI_REVIEW_DOCUMENTS",e.status),n=i.statusLists[e.statusListValue];return t&&0<n.length},function activate(){e.$$listeners[n.SAVED_PORTAL_REJECTION_REASON]||e.$on(n.SAVED_PORTAL_REJECTION_REASON,function(e,t,n){o.performStatusUpdate(r,t,n)});e.$$listeners[n.UPDATE_PLACEHOLDER_STATUS]||e.$on(n.UPDATE_PLACEHOLDER_STATUS,function(e,t,n){o.performStatusUpdate(r,t,n)})}()}angular.module("app").controller("StatusController",StatusController),StatusController.$inject=["$scope","$rootScope","commonService","permissionService","placeholderService","CONSTANTS"]}()},function(e,t){!function(){"use strict";function RightNavController(n,o,e,a,i,l,t,r,c,s,d){var u=this;function initializeDynamicVariables(){u.relationships=[],u.selectedRelationship=null,u.selectedRelationshipPlaceholders=[],u.noSelectedRelationshipPlaceholders=!0,u.pledgedCollateral=[],u.selectedCollateral=null,u.selectedCollateralPlaceholders=[],u.noSelectedCollateralPlaceholders=!0,u.isLoaded=!1,u.rightNavDisplay="",u.draggingFiles=!1,u.disableDraggingPromise=null,i.archivedFiles=[]}u.archive=e.ARCHIVE,u.relationship=e.RELATIONSHIP,u.fileStaging=e.FILE_STAGING,u.collateral=e.COLLATERAL,u.showPermanentDeleteModal=!1,u.placeholderToBeDeleted=null,u.rightNavIsBusy=!1,u.fileStagingService=t,u.configValues=d.get(),u.toggleRelationship=function toggleRelationship(e){u.selectedRelationship=e,u.rightNavSearchText="",u.selectedRelationshipPlaceholders=[],u.noSelectedRelationshipPlaceholders=!0,o.retrieveDocumentsWithAttachmentsForSpecifiedId(e.accountId,function(e){0<e.length?c.prepareForUrls(e).then(function(){u.selectedRelationshipPlaceholders=e}):n.$apply(function(){u.selectedRelationshipPlaceholders=e,u.noSelectedRelationshipPlaceholders=!1})},null)},u.togglePledgedCollateral=function togglePledgedCollateral(e){u.selectedCollateral=e,u.rightNavSearchText="",u.selectedCollateralPlaceholders=[],u.noSelectedCollateralPlaceholders=!0,e&&o.retrieveDocumentsWithAttachmentsForSpecifiedId(e.collateralId,function(e){0<e.length?c.prepareForUrls(e).then(function(){u.selectedCollateralPlaceholders=e}):n.$apply(function(){u.selectedCollateralPlaceholders=e,u.noSelectedCollateralPlaceholders=!1})},null)},u.toggleRightNav=function toggleRightNav(e){if(!u.rightNavIsBusy){var t=!(u.rightNavIsBusy=!0),n=!1;u.rightNavDisplay===e&&(t=!0),u.rightNavDisplay=e,u.isLoaded?u.rightNavIsBusy=(t?(u.rightNavDisplay="",u.isLoaded=!1):n=!0,!1):(n=!0,u.rightNavIsBusy=!(u.isLoaded=!0)),n&&u.initiateRemoteCallToRetrieveRightNavData()}},u.archiveFromFileStaging=function archiveFromFileStaging(e){var t=u.fileStagingService.stagedFiles.indexOf(e);l.archivePlaceholderFromFileStaging(e.recordId).then(function(){n.$evalAsync(function(){u.fileStagingService.stagedFiles.remove(u.fileStagingService.stagedFiles[t])}),o.retrieveArchivedDocumentsWithAttachments(function(e){c.prepareForUrls(e).then(function(){i.archivedFiles=e})})})},u.initiateRemoteCallToRetrieveRightNavData=function initiateRemoteCallToRetrieveRightNavData(){if(u.rightNavSearchText="",u.rightNavDisplay===u.relationship){if(u.relationships=[],u.configValues.contextObjectType===a.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&s.selectedProductInProductPackage.objectType===a.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE){var n=[];angular.forEach(s.productPackageProducts,function(e,t){l.retrieveLegalEntities(e.recordId).then(function(e){angular.forEach(e,function(e,t){e&&e.accountId&&n.indexOf(e.accountId)<0&&(n.push(e.accountId),u.relationships.push(e))})})})}else l.retrieveLegalEntities(window.DocManId).then(function(e){e&&(u.relationships=e)});u.isLoaded=!0}if(u.rightNavDisplay===u.collateral){u.pledgedCollateral=[];var r=[];u.configValues.contextObjectType===a.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE&&s.selectedProductInProductPackage.objectType===a.CONTEXT_OBJECT_TYPE_PRODUCT_PACKAGE?angular.forEach(s.productPackageProducts,function(e,t){e.objectType===a.CONTEXT_OBJECT_TYPE_LOAN&&r.push(e.recordId)}):r.push(window.DocManId),l.retrieveMultiplePledgedCollateral(r).then(function(e){e&&0<e.length&&(u.pledgedCollateral=e)})}u.rightNavDisplay===u.archive&&o.retrieveArchivedDocumentsWithAttachments(function(e){c.prepareForUrls(e).then(function(){i.archivedFiles=e,u.isLoaded=!0})});u.rightNavDisplay===u.fileStaging&&t.retrieveFileStagingPlaceholders().then(function(){u.isLoaded=!0})},u.initializeDynamicVariables=initializeDynamicVariables,u.permanentlyDelete=function permanentlyDelete(e){u.showPermanentDeleteModal=!0,u.placeholderToBeDeleted=e},u.cancelDelete=function cancelDelete(){u.showPermanentDeleteModal=!1,u.placeholderToBeDeleted=null},u.confirmDelete=function confirmDelete(){!function deletePlaceholderIndex(t){o.deletePlaceholderIndex(t.recordId,function(){n.$apply(function(){var e=i.archivedFiles.indexOf(t);i.archivedFiles.splice(e,1),u.placeholderToBeDeleted=null,u.showPermanentDeleteModal=!1})},null)}(u.placeholderToBeDeleted)},u.addFileFromLeftNav=function addFileFromLeftNav(){u.isLoaded||u.toggleRightNav(u.fileStaging)},u.toggleAllPlaceholders=function toggleAllPlaceholders(){var e=n.$parent.controller,t=[];t=!n.toggleState||e.totalPlaceholdersCount>e.placeHolderPaginationLimit&&!e.searchText&&!e.placeholderFilterValue?e.placeholderService.placeholders:n.filteredPlaceholders;angular.forEach(t,function(e,t){r.hasRequiredViewerAccess(e)&&(e.isSelected=n.toggleState)})},jQuery("#rightNavRelationshipTable").on("show.bs.collapse",function(n){n.target.getAttribute("uni-date-picker")||angular.forEach(u.relationships,function(e,t){e.accountId===n.target.id?(e.isOpen=!0,u.toggleRelationship(e)):(e.isOpen=!1,jQuery(a.HASH+e.accountId).removeClass(a.IN_CLASS))})}),jQuery("#rightNavCollateralTable").on("show.bs.collapse",function(n){n.target.getAttribute("uni-date-picker")||angular.forEach(u.pledgedCollateral,function(e,t){e.recordId===n.target.id?(e.isOpen=!0,u.togglePledgedCollateral(e)):(e.isOpen=!1,jQuery(a.HASH+e.recordId).removeClass(a.IN_CLASS))})}),jQuery("#rightNavRelationshipTable").on("hide.bs.collapse",function(e){if(!e.target.getAttribute("uni-date-picker"))for(var t=0;t<u.relationships.length;t++)if(u.relationships[t].accountId==e.target.id){n.$apply(function(){u.relationships[t].isOpen=!1});break}}),jQuery("#rightNavCollateralTable").on("hide.bs.collapse",function(e){if(!e.target.getAttribute("uni-date-picker"))for(var t=0;t<u.pledgedCollateral.length;t++)if(u.pledgedCollateral[t].recordId==e.target.id){n.$apply(function(){u.pledgedCollateral[t].isOpen=!1});break}}),initializeDynamicVariables()}angular.module("app").controller("RightNavController",RightNavController),RightNavController.$inject=["$scope","dataService","SECTION","CONSTANTS","$rootScope","universalDocManRemotingService","fileStagingService","permissionService","placeholderService","productPackageService","config"]}()},function(e,t){!function(){"use strict";function LeftNavController(e,t,o,n,a,r,i){var l=this;l.customLinks=[],l.showArchiveLink,function activate(){l.showArchiveLink=r.get().systemPropsMap.get(n.ARCHIVE_BROWSER_VISIBLE),function retrieveCustomLinks(){!function validateObjectArray(e){for(var t=0;t<e.length;t++){var n=!0;for(var r in a)e[t].hasOwnProperty(r)?typeof e[t][r]!=typeof a[r]&&(n=!1,console.log(r+o.TYPE_SHOULD_BE+typeof a[r])):(n=!1,console.log(o.REQUIRED_PROPERTY_MISSING+r));n&&l.customLinks.push(e[t])}}(t.customLinkDefinitions())}()}()}angular.module("app").controller("LeftNavController",LeftNavController),LeftNavController.$inject=["$scope","customLinkService","CONSTANTS","SYSTEM_PROPERTIES","CUSTOM_LINK_REQUIREMENTS","config","universalDocManRemotingService"]}()},function(e,t){!function(){"use strict";function draggable(r){return{restrict:"A",scope:{account:"=",placeholder:"=",hasPermission:"="},link:function link(n,e,t){n.hasPermission&&(e[0].draggable=!0,e.bind("dragstart",function processDragEvent(e){r.draggingFromRightNav=!0;var t=n.placeholder;n.account&&(t.accountId=n.account.accountId,t.relationship=n.account.name);(function getDataTransfer(e){return e.dataTransfer||e.originalEvent.dataTransfer})(e).setData("text",JSON.stringify(t))}))}}}angular.module("app").directive("draggable",draggable),draggable.$inject=["$rootScope"]}()},function(e,t){!function(){"use strict";function fileDropzone(l,c,s,d,o,u,f,p,E,t,e,n,r){var g=r.getLabels();return{restrict:"C",scope:{rightnavcontroller:"=rightnavcontroller",hasPermission:"="},link:function link(a,i,e){this.configValues=t.get(),a.hasPermission&&(i.bind(s.DRAG_OVER_EVENT,processDragOverOrEnter),i.bind(s.DRAG_ENTER_EVENT,processDragOverOrEnter),i.bind(s.DROP_EVENT,processDropEvent),i.bind(s.DRAG_LEAVE_EVENT,processDragOverOrEnter));function getDataTransfer(e){return e.dataTransfer||e.originalEvent.dataTransfer}function processDragOverOrEnter(e){var t=jQuery(e.target);return"dragleave"==e.type?t.removeClass("fileHover"):t.addClass("fileHover"),a.hasPermission?(e.type===s.DRAG_ENTER_EVENT||e.type===s.DRAG_OVER_EVENT?(u.draggingFromRightNav||i.addClass(s.STAGE_DRAGGED_CLASS),a&&a.$parent&&a.$parent.vm&&null!=a.$parent.vm.disableDraggingPromise&&($interval.cancel(a.$parent.vm.disableDraggingPromise),a.$parent.vm.disableDraggingPromise=null)):e.type===s.DRAG_LEAVE_EVENT&&i.removeClass(s.STAGE_DRAGGED_CLASS),e&&(e.preventDefault&&e.preventDefault(),e.stopPropagation)||(getDataTransfer(e).effectAllowed=s.COPY_EFFECT),!1):(i.unbind(s.DRAG_OVER_EVENT,processDragOverOrEnter),i.unbind(s.DRAG_ENTER_EVENT,processDragOverOrEnter),i.unbind(s.DROP_EVENT,processDropEvent),i.unbind(s.DRAG_LEAVE_EVENT,processDragOverOrEnter),!1)}function linkRelationshipDoc(n){var r,e={name:n.fileName,size:n.fileSize,type:n.mimeType};a.rightnavcontroller?r=a.rightnavcontroller:a.$parent.vm&&(r=a.$parent.vm),f.linkDocumentVersion(n.file.Id,a.$parent.placeholder.recordId,E.generateFileMetadata(a.$parent.placeholder,e),!0,!0===n.isDocumentExternal,n.file.Title).then(function(t){var e=a.$parent.placeholder.status;a.$parent.placeholder.newComment=d.getChatterStatusChangeComment(n.file.Title,e,s.STATUS_IN_FILE),a.$parent.controller.addChatterComment(a.$parent.placeholder),n.isDocumentExternal?(a.$parent.placeholder.isDocumentExternal=n.isDocumentExternal,a.$parent.placeholder.documentStorageType=n.documentStorageType):(a.$parent.placeholder.isDocumentExternal=!1,a.$parent.placeholder.documentStorageType=null),r.rightNavDisplay!==r.collateral&&(n.category&&""!==n.category||function handleFileStagingDocDeletion(n){c.deletePlaceholder(n.recordId,function(){a.$apply(function(){a.rightnavcontroller||(a.rightnavcontroller=a.$parent.vm),o.stagedFiles.forEach(function(e,t){if(e.recordId===n.recordId)return o.stagedFiles.remove(o.stagedFiles[t]),!1}),c.retrieveArchivedDocumentsWithAttachments(function(e){E.prepareForUrls(e).then(function(){u.archivedFiles=e})})})})}(n)),function updatePlaceholderFieldsEval(e,t){var n=p.defer();t.rightNavDisplay!=t.collateral&&t.rightNavDisplay!=t.relationship?n.resolve():f.updatePlaceholderFields(e.recordId,a.$parent.placeholder.recordId).then(function(){n.resolve()});return n.promise}(n,r).then(function(){f.savePlaceholderData(a.$parent.placeholder.recordId,null,null).then(function(e){E.copyPlaceholderProperties(e[0],a.$parent.placeholder),d.updatePlaceholderProperties(a.$parent.placeholder,a.$parent.controller.buildImageURL,t)})})})}function getProgressBarData(e,t){a.$parent.placeholder.fileUploadingText=g.UPLOADING+" "+e+" "+g.TO_LABEL+" "+t+" "+s.THREE_PERIODS}function processDropEvent(e){var t=new FileReader,n=getDataTransfer(e).files[0];if(!n){var r=JSON.parse(getDataTransfer(e).getData(s.GETDATA));return function handleRightNavFileDrop(t){a.$parent.placeholder.file&&a.$parent.placeholder.file.Id?a.$apply(function(){l.shouldOverwrite().then(function(e){e&&(getProgressBarData(t.file.Title,a.$parent.placeholder.name),d.uploadProgress(a.$parent.placeholder,null,100),l.archiveExistingDocument(a.$parent.placeholder).then(function(){linkRelationshipDoc(t)}))})}):(a.$apply(function(){getProgressBarData(t.file.Title,a.$parent.placeholder.name),d.uploadProgress(a.$parent.placeholder,null,100)}),linkRelationshipDoc(t))}(r),!1}if(1===getDataTransfer(e).files.length){u.draggingFromRightNav=!1;var o=s.MAX_FILE_SIZE;i.removeClass("stageDragged"),null!=e&&e.preventDefault(),t.onload=function(e){n.size<o?function uploadFile(r,o,n){getProgressBarData(o.name,r.$parent.placeholder.name),E.uploadingToPlaceholder=r.$parent.placeholder,d.checkForExistingContentDocument(r.$parent.placeholder.file).then(function(e){var t=e[1];l.uploadContentDocument(o,n,function(e){var n=r.$parent.placeholder.status;e.isExternal&&!0===e.isExternal||(f.createDocumentStorageMetadata(e.id,r.$parent.placeholder.recordId,t,E.generateFileMetadata(r.$parent.placeholder,o)).then(function(t){f.savePlaceholderData(r.$parent.placeholder.recordId,null,null).then(function(e){E.copyPlaceholderProperties(e[0],r.$parent.placeholder),d.updatePlaceholderProperties(r.$parent.placeholder,r.$parent.controller.buildImageURL,t),r.$parent.placeholder.newComment=d.getChatterStatusChangeComment(o.name,n,s.STATUS_IN_FILE),r.$parent.controller.addChatterComment(r.$parent.placeholder)})}),r.$parent.placeholder.isDocumentExternal&&(r.$parent.placeholder.isDocumentExternal=!1,r.$parent.placeholder.documentStorageType=null))},function(e,t,n){e!==s.CANCEL_OVERWRITE&&(r.$parent.placeholder.uploadingFile=!1,E.uploadingToPlaceholder={})},function(e){r.$evalAsync(function(){d.uploadProgress(r.$parent.placeholder,e)})})})}(a,n,e.target.result):(c.dispatchErrorEvent("",g.MAX_FILE_SIZE_ERROR),a.$apply(function(){i.children().removeClass("imageDrag")}))},t.readAsDataURL(n)}else c.dispatchErrorEvent("",g.MULTIPLE_UPLOAD_ERROR),a.$apply(function(){i.removeClass("stageDragged"),i.children().removeClass("imageDrag")})}}}}angular.module("app").directive("fileDropzone",fileDropzone),fileDropzone.$inject=["uploadService","dataService","CONSTANTS","commonService","fileStagingService","$rootScope","universalDocManRemotingService","$q","placeholderService","config","ALERT_DIALOG","TOAST_TYPES","labels"]}()},function(e,t){!function(){"use strict";function imageOnLoad(r){return{restrict:"C",scope:{placeholder:"=",hasPermission:"="},link:function link(t,n,e){n.bind("load",function processLoad(e){t.$apply(function(){t&&t.$parent&&(t.$parent.controller&&(e.target.attributes.Id.value==r.TARGET_LARGE_IMG_PREVIEW?clearInterval(t.$parent.controller.enlargedPreviewLoadingInterval):clearInterval(t.$parent.controller.imagePreviewLoadingInterval)),t.placeholder&&!t.placeholder.file&&(t.placeholder.file={}),e.target.attributes.Id.value==r.TARGET_LARGE_IMG_PREVIEW?(t.$parent.controller.enlargedPreviewLoaded=!0,t.$parent.controller.isLoadingLargeImage=!1):t.placeholder.file.previewLoaded=!0),n.removeClass("imageDrag"),t.$parent.controller.proccessErrorOccurred=!1})}),n.bind("error",function processError(e){e.target.attributes.Id.value==r.TARGET_LARGE_IMG_PREVIEW&&(t.$parent.controller.processErrorOccurred||t.$apply(function(){t.$parent.controller.proccessErrorOccurred=!0}))}),t.hasPermission&&(n.bind("dragenter",processDragEnter),n.bind("dragover",processDragEnter),n.bind("dragleave",function processDragLeave(e){t.$apply(function(){n.removeClass("imageDrag")})}),t.placeholder&&n.bind("click",function showExpandedPreview(){t.placeholder.file.previewUnavailable||t.placeholder.isDocumentExternal||t.$parent&&t.$parent.controller&&(t.$parent.controller.isLoadingLargeImage=!0,t.$parent.controller.showExpandedPreview(t.placeholder))}));function processDragEnter(e){t.$apply(function(){n.addClass("imageDrag")})}}}}angular.module("app").constant("ELEMENTS",{TARGET_LARGE_IMG_PREVIEW:"largeImagePreview"}).directive("imageOnLoad",imageOnLoad),imageOnLoad.$inject=["ELEMENTS"]}()},function(e,t){!function(){"use strict";function browse(i,l,c,s,d,r,e,u,f){e.get();var p=f.getLabels();return{restrict:"C",scope:{data:"=placeholder"},link:function link(a,t,e){var i=jQuery(t[0]),n=i.siblings(":file");function handleInputFiles(e){for(var n=e.target.files,r=c.MAX_FILE_SIZE,o=0,t=0;t<n.length;t++)!function(t){var e=new FileReader;e.onload=function(e){t.size<r?null!=a.data?processFileUpload(t,e.target.result,a,function(){resetFileInput(i)}):s.createFileStagingPlaceholder(t,e.target.result,a,function(){++o===n.length&&resetFileInput(i)}):l.dispatchErrorEvent("",p.INDIVIDUAL_MAX_FILE_SIZE_ERROR)},e.readAsDataURL(t)}(n[t])}i.unbind("click"),i.click(function(e){n.trigger("click")}),n.unbind(c.CHANGE_EVENT),n.bind(c.CHANGE_EVENT,function processChange(e){"addNewFile"===t[0].id?r.retrieveFileStagingPlaceholders().then(function(){a.$parent.vm.rightNavDisplay=a.$parent.vm.fileStaging,jQuery(".rightNav").toggle("slide",{direction:"right"},500,function(){a.$parent.vm.isLoaded=!0,a.$parent.vm.rightNavIsBusy=!1}),handleInputFiles(e)}):handleInputFiles(e)})}};function processFileUpload(r,n,o,a){o.data.fileUploadingText=p.UPLOADING+" "+r.name+" "+p.TO_LABEL+" "+o.data.name+c.THREE_PERIODS,s.checkForExistingContentDocument(o.data.file).then(function(e){var t=e[1];d.uploadingToPlaceholder=o.data,i.uploadContentDocument(r,n,function(e){var n=o.data.status;o.data.status=f.getLabel(c.STATUS_IN_FILE),!0!==e.isExternal?u.createDocumentStorageMetadata(e.id,o.data.recordId,t,d.generateFileMetadata(o.data,r)).then(function(t){o.$parent.controller.selectedPlaceholder.newComment=s.getChatterStatusChangeComment(r.name,n,c.STATUS_IN_FILE),o.$parent.controller.addChatterComment(o.$parent.controller.selectedPlaceholder),u.savePlaceholderData(o.data.recordId,null,null).then(function(e){d.copyPlaceholderProperties(e[0],o.data),s.updatePlaceholderProperties(o.data,o.$parent.controller.buildImageURL,t),a&&a()})}):a&&a()},function(e,t,n){o.data.uploadingFile=!1,d.uploadingToPlaceholder={},console.log(e),console.log(t),console.log(n)},function(e){s.uploadProgress(o.data,e)})})}function resetFileInput(e){c.IS_IE&&c.IS_IE<10?e.val(null):e.siblings(":file").val(null)}}angular.module("app").directive("uniBrowse",browse),browse.$inject=["uploadService","dataService","CONSTANTS","commonService","placeholderService","fileStagingService","config","universalDocManRemotingService","labels"]}()},function(e,t){!function(){"use strict";function stageDrop(i,l,t,c,s,e){var d=e.getLabels();return{restrict:"C",scope:{},link:function link(o,a,e){function processDragOverOrEnter(e){return e.type===i.DRAG_ENTER_EVENT||e.type===i.DRAG_OVER_EVENT?(c.draggingFromRightNav||a.addClass("stageDragged"),null!=o.$parent.vm.disableDraggingPromise&&(t.cancel(o.$parent.vm.disableDraggingPromise),o.$parent.vm.disableDraggingPromise=null)):e.type===i.DRAG_LEAVE_EVENT&&a.removeClass("stageDragged"),e&&(e.preventDefault&&e.preventDefault(),e.stopPropagation),!1}function hasAllowedExtension(e){var t=e.name.substr(e.name.lastIndexOf(".")+1).toLowerCase();return-1!==c.allowedFileExtensions.indexOf(t)}function validateFiles(e){if(!c.allowedFileExtensions||0===c.allowedFileExtensions.length||""===c.allowedFileExtensions)return e;for(var t=[],n=[],r=0;r<e.length;r++)hasAllowedExtension(e[r])?n.push(e[r]):t.push(e[r].name);return 0<t.length&&s.dispatchErrorEvent("",d.INVALID_FILE_EXTENSIONS_PART_1+" ",null,d.INVALID_FILE_EXTENSIONS_PART_2+" "+t.join(", ")+"\n"+d.VALID_FILE_EXTENSIONS+c.allowedFileExtensions.join(", ")),n}a.bind(i.DRAG_OVER_EVENT,processDragOverOrEnter),a.bind(i.DRAG_ENTER_EVENT,processDragOverOrEnter),a.bind(i.DRAG_LEAVE_EVENT,processDragOverOrEnter),a.bind(i.DROP_EVENT,function processDrop(e){null!=e&&e.preventDefault();c.draggingFromRightNav=!1,a.removeClass("stageDragged"),o.$parent.vm.draggingFiles=!1;var t=e.target.files;e.type===i.DROP_EVENT&&(t=l.getDataTransfer(e).files);if(t.length<=i.MAX_NUMBER_DRAGGED_FILES){if(0<(t=validateFiles(t)).length)for(var n=i.MAX_FILE_SIZE,r=0;r<t.length;r++)!function(t){var e=new FileReader;e.onload=function(e){t.size<n?l.createFileStagingPlaceholder(t,e.target.result,o):s.dispatchErrorEvent("",d.INDIVIDUAL_MAX_FILE_SIZE_ERROR)},e.readAsDataURL(t)}(t[r])}else s.dispatchErrorEvent("",d.MAX_NUMBER_DRAGGED_FILES_ERROR)})}}}angular.module("app").directive("uniStageDrop",stageDrop),stageDrop.$inject=["CONSTANTS","commonService","$interval","$rootScope","dataService","labels"]}()},function(e,t){!function(){"use strict";function rightClick(c,e,t){return{restrict:"A",scope:{controller:"=controller",data:"=placeholder"},link:function link(i,e,t,n){var l=jQuery(e[0]);l.bind("contextmenu",function(a){i.$apply(function(){a.preventDefault(),i.controller.rightClickedPlaceholder=i.data,i.controller.showContextMenu=!0;var e=jQuery(c.MENU_SELECTOR),t=e.outerWidth(),n=e.outerHeight(),r=a.pageX-5,o=a.pageY;r-l.offset().left+t>l.width()&&(r-=t),o-jQuery(c.PARENT_SELECTOR).offset().top+n>jQuery(c.PARENT_SELECTOR).height()&&(o-=n),e.css({display:"block",position:"absolute",left:r,top:o}),e.appendTo("body")})})}}}angular.module("app").constant("RIGHT_CLICK_CONSTANTS",{MENU_SELECTOR:"#placeholderContextMenu",PARENT_SELECTOR:"#docmanapp"}).directive("rightClick",rightClick),rightClick.$inject=["RIGHT_CLICK_CONSTANTS","PERMISSIONS","permissionService"]}()},function(e,t){!function(){"use strict";function addFile(d,u,f,e,p,E,t,g,n){t.get();var h=n.getLabels();return{restrict:"C",scope:{placeholder:"=placeholder"},link:function link(s,n,e){var t=jQuery(n[0]),r=t.siblings(":file");t.unbind("click"),t.click(function(e){r.trigger("click")}),r.unbind(f.CHANGE_EVENT),r.bind(f.CHANGE_EVENT,function processChange(t){"rightClickAddFile"===n[0].id&&document.getElementById("hideContextMenu").click();var l=f.MAX_FILE_SIZE,c=t.target.files[0],e=new FileReader;e.onload=function(e){var r,o,n,a,i;c.size<l?(r=s,o=c,n=e.target.result,a=function(){jQuery(t.target).val(null)},(i=getSelectedPlaceholder(r)).fileUploadingText=h.UPLOADING+" "+o.name+" "+h.TO_LABEL+" "+i.name+f.THREE_PERIODS,E.uploadingToPlaceholder=i,p.checkForExistingContentDocument(i.file).then(function(e){var t=e[1];d.uploadContentDocument(o,n,function(e){var n=i.status;!0!==e.isExternal?g.createDocumentStorageMetadata(e.id,i.recordId,t,E.generateFileMetadata(i,o)).then(function(t){i.newComment=p.getChatterStatusChangeComment(o.name,n,f.STATUS_IN_FILE),r.$parent.controller.addChatterComment(i),g.savePlaceholderData(i.recordId,null,null).then(function(e){E.copyPlaceholderProperties(e[0],i),p.updatePlaceholderProperties(i,r.$parent.controller.buildImageURL,t),i.isDocumentExternal&&(i.isDocumentExternal=!1,i.documentStorageType=null),a&&a()})}):a&&a()},function(e,t,n){e===f.CANCEL_OVERWRITE?a&&a():r.$apply(function(){i.uploadingFile=!1,E.uploadingToPlaceholder={},console.log(e),console.log(t),console.log(n)})},function(e){r.$apply(function(){p.uploadProgress(i,e)})})})):u.dispatchErrorEvent("",c.name+" "+h.INDIVIDUAL_MAX_FILE_SIZE_ERROR)},c&&e.readAsDataURL(c)})}};function getSelectedPlaceholder(e){var t;if(typeof e.placeholder==="undefined"){t=e.$parent.placeholder}else{t=e.placeholder}return t}}angular.module("app").directive("uniAddFile",addFile),addFile.$inject=["uploadService","dataService","CONSTANTS","$rootScope","commonService","placeholderService","config","universalDocManRemotingService","labels"]}()},function(e,t){!function(){"use strict";function uniHasPermission(i,l,c,s){return{restrict:"A",link:function link(e,t,n){this.configValues=s.get();var r=n.uniHasPermission.trim(),o=this.configValues.contextObjectType,a=l.hasPermission(o,r);function updateElements(e){if(e)switch(t.prop("nodeName")){case"TEXTAREA":t.attr("readonly",!1);break;case"BUTTON":t.prop("disabled",!1),t.removeClass("disabled");break;case"DIV":jQuery(t).show();break;case"A":t.prop("disabled",!1),t.removeClass("disabled");break;case"SPAN":t.removeClass("hidden")}else switch(t.prop("nodeName")){case"TEXTAREA":t.attr("readonly",!0);break;case"BUTTON":t.prop("disabled",!0),t.addClass("disabled");break;case"DIV":jQuery(t).hide();break;case"A":t.prop("disabled",!0),t.addClass("disabled");break;case"SPAN":t.addClass("hidden")}}i.$on(c.CHANGED_PRODUCT_PACKAGE_PRODUCT,function(e,t){updateElements(l.hasPermission(t,r))}),updateElements(a)}}}angular.module("app").directive("uniHasPermission",uniHasPermission),uniHasPermission.$inject=["$rootScope","permissionService","CONSTANTS","config"]}()},function(e,t){!function(){"use strict";angular.module("app").directive("clickOutside",clickOutside);var s="clickOutside";function clickOutside(l,c){return{restrict:"A",link:function link(n,r,e,t){var o=jQuery(r[0]),a=c(e[s]),i=function(e){var t=r[0]!==e.target&&0===o.find(e.target).length;t&&n.$apply(function(){a(n,{})})};l.on("click",i),n.$on("$destroy",function(){l.off("click",i)})}}}clickOutside.$inject=["$document","$parse"]}()},function(e,t){!function(){"use strict";angular.module("app").directive("errorHandler",errorHandler);function errorHandler(r,o){return{restrict:"C",link:function link(t,e,n){jQuery(window).on(r.ERROR_EVENT,function(e){t.$apply(function(){t.controller.toastType=o.ERROR,t.controller.toast=e.message,t.controller.toastSubHeading=e.toastSubHeading})})}}}errorHandler.$inject=["CONSTANTS","TOAST_TYPES"]}()},function(e,t){!function(){function infiniteScroll(E,o,g,h){return{restrict:"A",scope:{infiniteScroll:"&",infiniteScrollContainer:"=",infiniteScrollDistance:"=",infiniteScrollDisabled:"=",infiniteScrollUseDocumentBottom:"=",infiniteScrollListenForEvent:"@"},link:function link(a,i,e){var l=angular.element(o),c=null,s=null,d=null,u=null,t=!0,f=!1,n=null,p=!1;function height(e){var t=e[0]||e;return isNaN(t.offsetHeight)?t.document.documentElement.clientHeight:t.offsetHeight}function pageYOffset(e){var t=e[0]||e;return isNaN(window.pageYOffset)?t.document.documentElement.scrollTop:t.ownerDocument.defaultView.pageYOffset}function offsetTop(e){if(e[0].getBoundingClientRect&&!e.css("none"))return e[0].getBoundingClientRect().top+pageYOffset(e)}function defaultHandler(){var e,t;if(u===l)e=height(u)+pageYOffset(u[0].document.documentElement),t=offsetTop(i)+height(i);else{e=height(u);var n=0;void 0!==offsetTop(u)&&(n=offsetTop(u)),t=offsetTop(i)-n+height(i)}f&&(t=height((i[0].ownerDocument||i[0].document).documentElement));var r=t-e,o=r<=height(u)*c+1;o?(d=!0,s&&(a.$$phase||E.$$phase?a.infiniteScroll():a.$apply(a.infiniteScroll))):(p&&g.cancel(p),d=!1)}var r=null!=h?function throttle(n,r){var o=null,a=0;function later(){return a=(new Date).getTime(),g.cancel(o),o=null,n.call()}function throttled(){var e=(new Date).getTime(),t=r-(e-a);t<=0?(g.cancel(o),o=null,a=e,n.call()):o||(o=g(later,t,1))}return throttled}(defaultHandler,h):defaultHandler;function handleInfiniteScrollDistance(e){c=parseFloat(e)||0}function handleInfiniteScrollDisabled(e){(s=!e)&&d&&(d=!1,r())}function handleInfiniteScrollUseDocumentBottom(e){f=e}function changeContainer(e){null!=u&&u.unbind("scroll",r),null!=(u=e)&&u.bind("scroll",r)}a.$on("$destroy",function handleDestroy(){u.unbind("scroll",r),null!=n&&(n(),n=null),p&&g.cancel(p)}),a.$watch("infiniteScrollDistance",handleInfiniteScrollDistance),handleInfiniteScrollDistance(a.infiniteScrollDistance),a.$watch("infiniteScrollDisabled",handleInfiniteScrollDisabled),handleInfiniteScrollDisabled(a.infiniteScrollDisabled),a.$watch("infiniteScrollUseDocumentBottom",handleInfiniteScrollUseDocumentBottom),handleInfiniteScrollUseDocumentBottom(a.infiniteScrollUseDocumentBottom),changeContainer(l),a.infiniteScrollListenForEvent&&(n=E.$on(a.infiniteScrollListenForEvent,r));function handleInfiniteScrollContainer(e){if(null!=e&&0!==e.length){var t;if(null==(t=e.nodeType&&1===e.nodeType?angular.element(e):"function"==typeof e.append?angular.element(e[e.length-1]):"string"==typeof e?angular.element(document.querySelector(e)):e))throw new Error("invalid infinite-scroll-container attribute.");changeContainer(t)}}a.$watch("infiniteScrollContainer",handleInfiniteScrollContainer),handleInfiniteScrollContainer(a.infiniteScrollContainer||[]),null!=e.infiniteScrollParent&&changeContainer(angular.element(i.parent()));null!=e.infiniteScrollImmediateCheck&&(t=a.$eval(e.infiniteScrollImmediateCheck));return p=g(function intervalCheck(){return t&&r(),g.cancel(p)})}}}angular.module("app").directive("infiniteScroll",infiniteScroll).value("THROTTLE_MILLISECONDS",null),infiniteScroll.$inject=["$rootScope","$window","$interval","THROTTLE_MILLISECONDS"]}()},function(e,t){!function(){"use strict";angular.module("app").directive("ndsDateValueDocMan",function ndsDateValue(){return{restrict:"A",scope:{ndsDateValueDocMan:"="},link:function(n,e){e[0].value=n.ndsDateValueDocMan,e.bind("valueChange",function(t){n.$apply(function(){var e=t.originalEvent.detail;n.ndsDateValueDocMan=null!==e?e:null})})}}})}()},function(e,t){!function(){"use strict";angular.module("app").directive("ndsDatetimeValue",function ndsDatetimeValue(){return{restrict:"A",scope:{ndsDatetimeValue:"="},link:function(n,e){e[0].value=n.ndsDatetimeValue,e.bind("valueChange",function(t){n.$apply(function(){var e=t.originalEvent.detail;n.ndsDatetimeValue=null!==e?e:null})})}}})}()},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){}]);